var se=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var _=(e,t,r)=>(se(e,t,"read from private field"),r?r.call(e):t.get(e)),ae=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},ce=(e,t,r,n)=>(se(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{v as E}from"./json.43dbb4f7.js";import{f as Oe}from"./ffmpeg.9983e737.js";import{t as Ce,l as Pe,a as Se}from"./vendor.629c226a.js";import{c as u}from"./opencv.be337fbb.js";function P(){}const Ne=e=>e;function le(e,t){for(const r in t)e[r]=t[r];return e}function ue(e){return e()}function fe(){return Object.create(null)}function D(e){e.forEach(ue)}function ke(e){return typeof e=="function"}function Te(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let V;function xt(e,t){return V||(V=document.createElement("a")),V.href=t,e===V.href}function Le(e){return Object.keys(e).length===0}function Be(e,...t){if(e==null)return P;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function At(e,t,r){e.$$.on_destroy.push(Be(t,r))}function Mt(e){const t={};for(const r in e)r[0]!=="$"&&(t[r]=e[r]);return t}function Ot(e){return e==null?"":e}function Ct(e,t,r){return e.set(r),t}const de=typeof window!="undefined";let je=de?()=>window.performance.now():()=>Date.now(),he=de?e=>requestAnimationFrame(e):P;const B=new Set;function pe(e){B.forEach(t=>{t.c(e)||(B.delete(t),t.f())}),B.size!==0&&he(pe)}function Ie(e){let t;return B.size===0&&he(pe),{promise:new Promise(r=>{B.add(t={c:e,f:r})}),abort(){B.delete(t)}}}function Pt(e,t){e.appendChild(t)}function St(e,t,r){e.insertBefore(t,r||null)}function $e(e){e.parentNode.removeChild(e)}function Nt(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function kt(e){return document.createElement(e)}function Tt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function ge(e){return document.createTextNode(e)}function Lt(){return ge(" ")}function Bt(){return ge("")}function jt(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function It(e){return function(t){return t.preventDefault(),e.call(this,t)}}function De(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function $t(e,t){for(const r in t)De(e,r,t[r])}function Dt(e){return e===""?null:+e}function He(e){return Array.from(e.childNodes)}function Ht(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Ut(e,t){e.value=t==null?"":t}function Ft(e,t,r){e.classList[r?"add":"remove"](t)}let me;function z(e){me=e}function Vt(e,t){const r=e.$$.callbacks[t.type];r&&r.slice().forEach(n=>n.call(this,t))}const H=[],we=[],q=[],ve=[],Ue=Promise.resolve();let Q=!1;function Fe(){Q||(Q=!0,Ue.then(be))}function ee(e){q.push(e)}let te=!1;const re=new Set;function be(){if(!te){te=!0;do{for(let e=0;e<H.length;e+=1){const t=H[e];z(t),Ve(t.$$)}for(z(null),H.length=0;we.length;)we.pop()();for(let e=0;e<q.length;e+=1){const t=q[e];re.has(t)||(re.add(t),t())}q.length=0}while(H.length);for(;ve.length;)ve.pop()();Q=!1,te=!1,re.clear()}}function Ve(e){if(e.fragment!==null){e.update(),D(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ee)}}const G=new Set;let S;function zt(){S={r:0,c:[],p:S}}function qt(){S.r||D(S.c),S=S.p}function ze(e,t){e&&e.i&&(G.delete(e),e.i(t))}function Gt(e,t,r,n){if(e&&e.o){if(G.has(e))return;G.add(e),S.c.push(()=>{G.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}}function Xt(e,t){const r={},n={},o={$$scope:1};let i=e.length;for(;i--;){const l=e[i],s=t[i];if(s){for(const a in l)a in s||(n[a]=1);for(const a in s)o[a]||(r[a]=s[a],o[a]=1);e[i]=s}else for(const a in l)o[a]=1}for(const l in n)l in r||(r[l]=void 0);return r}function Yt(e){e&&e.c()}function qe(e,t,r,n){const{fragment:o,on_mount:i,on_destroy:l,after_update:s}=e.$$;o&&o.m(t,r),n||ee(()=>{const a=i.map(ue).filter(ke);l?l.push(...a):D(a),e.$$.on_mount=[]}),s.forEach(ee)}function Ge(e,t){const r=e.$$;r.fragment!==null&&(D(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function Xe(e,t){e.$$.dirty[0]===-1&&(H.push(e),Fe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Wt(e,t,r,n,o,i,l,s=[-1]){const a=me;z(e);const c=e.$$={fragment:null,ctx:null,props:i,update:P,not_equal:o,bound:fe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:fe(),dirty:s,skip_bound:!1,root:t.target||a.$$.root};l&&l(c.root);let d=!1;if(c.ctx=r?r(e,t.props||{},(f,h,...p)=>{const w=p.length?p[0]:h;return c.ctx&&o(c.ctx[f],c.ctx[f]=w)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](w),d&&Xe(e,f)),h}):[],c.update(),d=!0,D(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){const f=He(t.target);c.fragment&&c.fragment.l(f),f.forEach($e)}else c.fragment&&c.fragment.c();t.intro&&ze(e.$$.fragment),qe(e,t.target,t.anchor,t.customElement),be()}z(a)}class Jt{$destroy(){Ge(this,1),this.$destroy=P}$on(t,r){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(t){this.$$set&&!Le(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ye=(e,t)=>{let r=t.name+((t.name==="\u751F\u547D\u503C"||t.name==="\u653B\u51FB\u529B")&&t.value.includes("%")?"%":"");return E.part2mainkey.hasOwnProperty(e)&&E.part2mainkey[e].includes(r)},We=(e,t)=>{let r=t.name+((t.name==="\u751F\u547D\u503C"||t.name==="\u653B\u51FB\u529B")&&t.value.includes("%")?"%":""),n=E.part2mainkey.hasOwnProperty(e)&&E.part2mainkey[e].includes(r),o=E.mainkey2mainvalue.hasOwnProperty(r)&&E.mainkey2mainvalue[r].includes(t.value);return n&&o},X=e=>{let t=e.name+((e.name==="\u751F\u547D\u503C"||e.name==="\u653B\u51FB\u529B"||e.name==="\u9632\u5FA1\u529B")&&e.value.includes("%")?"%":"");return E.secondkey2secondvalue.hasOwnProperty(t)&&E.secondkey2secondvalue[t].includes(e.value)},Je=e=>E.alternative.includes(e),Ze=e=>{let t=e.name+((e.name==="\u751F\u547D\u503C"||e.name==="\u653B\u51FB\u529B")&&e.value.includes("%")?"%":""),r=[];return[[0,5],[5,10],[10,23],[23,40],[40,61]].forEach((n,o)=>{E.mainkey2mainvalue[t].slice(n[0],n[1]).includes(e.value)&&r.push([o+1,E.mainkey2mainvalue[t].slice(n[0],n[1]).indexOf(e.value)])}),r},Y=e=>{let t=e.name+((e.name==="\u751F\u547D\u503C"||e.name==="\u653B\u51FB\u529B"||e.name==="\u9632\u5FA1\u529B")&&e.value.includes("%")?"%":""),r=[];return[[0,2],[2,5],[5,16],[16,47],[47,98]].forEach((n,o)=>{E.secondkey2secondvalue[t].slice(n[0],n[1]).includes(e.value)&&r.push([o+1,E.secondkey2secondvalue[t].slice(n[0],n[1]).indexOf(e.value)])}),r.map(([n,o])=>{if(o<4)return[n,1];if(o<4+7)return[n,2];if(o<4+7+10)return[n,3];if(o<4+7+10+10)return[n,4];if(o<4+7+10+10+10)return[n,5];if(o<4+7+10+10+10+10)return[n,6]})},Zt=e=>{let t=[Ye(e.part,e.main),We(e.part,e.main),X(e.second1),X(e.second2),X(e.second3),X(e.second4),Je(e.alternative)];if(!t.includes(!1)){let r=Ze(e.main),n=Y(e.second1),o=Y(e.second2),i=Y(e.second3),l=Y(e.second4),s=!1;r.forEach(([a,c])=>{let d=a-2+c/4;if(n.find(f=>f[0]==a)&&o.find(f=>f[0]==a)&&i.find(f=>f[0]==a)&&l.find(f=>f[0]==a)){let f=n.find(h=>h[0]==a)[1]+o.find(h=>h[0]==a)[1]+i.find(h=>h[0]==a)[1]+l.find(h=>h[0]==a)[1];(d==f||d==f-1)&&(s=!0)}}),console.log(s)}return t},j=[];function M(e,t=P){let r;const n=new Set;function o(s){if(Te(e,s)&&(e=s,r)){const a=!j.length;for(const c of n)c[1](),j.push(c,e);if(a){for(let c=0;c<j.length;c+=2)j[c][0](j[c+1]);j.length=0}}}function i(s){o(s(e))}function l(s,a=P){const c=[s,a];return n.add(c),n.size===1&&(r=t(o)||P),s(e),()=>{n.delete(c),n.size===0&&(r(),r=null)}}return{set:o,update:i,subscribe:l}}function Ke(e){const t=e-1;return t*t*t+1}function _e(e){return Object.prototype.toString.call(e)==="[object Date]"}function ne(e,t){if(e===t||e!==e)return()=>e;const r=typeof e;if(r!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((o,i)=>ne(e[i],o));return o=>n.map(i=>i(o))}if(r==="object"){if(!e||!t)throw new Error("Object cannot be null");if(_e(e)&&_e(t)){e=e.getTime(),t=t.getTime();const i=t-e;return l=>new Date(e+l*i)}const n=Object.keys(t),o={};return n.forEach(i=>{o[i]=ne(e[i],t[i])}),i=>{const l={};return n.forEach(s=>{l[s]=o[s](i)}),l}}if(r==="number"){const n=t-e;return o=>e+o*n}throw new Error(`Cannot interpolate ${r} values`)}function Qe(e,t={}){const r=M(e);let n,o=e;function i(l,s){if(e==null)return r.set(e=l),Promise.resolve();o=l;let a=n,c=!1,{delay:d=0,duration:f=400,easing:h=Ne,interpolate:p=ne}=le(le({},t),s);if(f===0)return a&&(a.abort(),a=null),r.set(e=o),Promise.resolve();const w=je()+d;let m;return n=Ie(b=>{if(b<w)return!0;c||(m=p(e,l),typeof f=="function"&&(f=f(e,l)),c=!0),a&&(a.abort(),a=null);const y=b-w;return y>f?(r.set(e=l),!1):(r.set(e=m(h(y/f))),!0)}),n.promise}return{set:i,update:(l,s)=>i(l(o,e),s),subscribe:r.subscribe}}const Kt={video:M(),images:M(),setting:{x:M(),y:M(),width:M(),height:M()}},Qt=M(),er=M(),tr=Qe(0,{duration:1e3,easing:Ke});var et=20,tt=1,N=1e6,Ee=1e6,rt=-7,nt=21,ot=!1,U="[big.js] ",k=U+"Invalid ",W=k+"decimal places",it=k+"rounding mode",Re=U+"Division by zero",g={},A=void 0,st=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function ye(){function e(t){var r=this;if(!(r instanceof e))return t===A?ye():new e(t);if(t instanceof e)r.s=t.s,r.e=t.e,r.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0)throw TypeError(k+"number");t=t===0&&1/t<0?"-0":String(t)}at(r,t)}r.constructor=e}return e.prototype=g,e.DP=et,e.RM=tt,e.NE=rt,e.PE=nt,e.strict=ot,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function at(e,t){var r,n,o;if(!st.test(t))throw Error(k+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),o=t.length,n=0;n<o&&t.charAt(n)=="0";)++n;if(n==o)e.c=[e.e=0];else{for(;o>0&&t.charAt(--o)=="0";);for(e.e=r-n-1,e.c=[],r=0;n<=o;)e.c[r++]=+t.charAt(n++)}return e}function T(e,t,r,n){var o=e.c;if(r===A&&(r=e.constructor.RM),r!==0&&r!==1&&r!==2&&r!==3)throw Error(it);if(t<1)n=r===3&&(n||!!o[0])||t===0&&(r===1&&o[0]>=5||r===2&&(o[0]>5||o[0]===5&&(n||o[1]!==A))),o.length=1,n?(e.e=e.e-t+1,o[0]=1):o[0]=e.e=0;else if(t<o.length){if(n=r===1&&o[t]>=5||r===2&&(o[t]>5||o[t]===5&&(n||o[t+1]!==A||o[t-1]&1))||r===3&&(n||!!o[0]),o.length=t--,n)for(;++o[t]>9;)o[t]=0,t--||(++e.e,o.unshift(1));for(t=o.length;!o[--t];)o.pop()}return e}function I(e,t,r){var n=e.e,o=e.c.join(""),i=o.length;if(t)o=o.charAt(0)+(i>1?"."+o.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)o="0"+o;o="0."+o}else if(n>0)if(++n>i)for(n-=i;n--;)o+="0";else n<i&&(o=o.slice(0,n)+"."+o.slice(n));else i>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&r?"-"+o:o}g.abs=function(){var e=new this.constructor(this);return e.s=1,e};g.cmp=function(e){var t,r=this,n=r.c,o=(e=new r.constructor(e)).c,i=r.s,l=e.s,s=r.e,a=e.e;if(!n[0]||!o[0])return n[0]?i:o[0]?-l:0;if(i!=l)return i;if(t=i<0,s!=a)return s>a^t?1:-1;for(l=(s=n.length)<(a=o.length)?s:a,i=-1;++i<l;)if(n[i]!=o[i])return n[i]>o[i]^t?1:-1;return s==a?0:s>a^t?1:-1};g.div=function(e){var t=this,r=t.constructor,n=t.c,o=(e=new r(e)).c,i=t.s==e.s?1:-1,l=r.DP;if(l!==~~l||l<0||l>N)throw Error(W);if(!o[0])throw Error(Re);if(!n[0])return e.s=i,e.c=[e.e=0],e;var s,a,c,d,f,h=o.slice(),p=s=o.length,w=n.length,m=n.slice(0,s),b=m.length,y=e,Z=y.c=[],K=0,$=l+(y.e=t.e-e.e)+1;for(y.s=i,i=$<0?0:$,h.unshift(0);b++<s;)m.push(0);do{for(c=0;c<10;c++){if(s!=(b=m.length))d=s>b?1:-1;else for(f=-1,d=0;++f<s;)if(o[f]!=m[f]){d=o[f]>m[f]?1:-1;break}if(d<0){for(a=b==s?o:h;b;){if(m[--b]<a[b]){for(f=b;f&&!m[--f];)m[f]=9;--m[f],m[b]+=10}m[b]-=a[b]}for(;!m[0];)m.shift()}else break}Z[K++]=d?c:++c,m[0]&&d?m[b]=n[p]||0:m=[n[p]]}while((p++<w||m[0]!==A)&&i--);return!Z[0]&&K!=1&&(Z.shift(),y.e--,$--),K>$&&T(y,$,r.RM,m[0]!==A),y};g.eq=function(e){return this.cmp(e)===0};g.gt=function(e){return this.cmp(e)>0};g.gte=function(e){return this.cmp(e)>-1};g.lt=function(e){return this.cmp(e)<0};g.lte=function(e){return this.cmp(e)<1};g.minus=g.sub=function(e){var t,r,n,o,i=this,l=i.constructor,s=i.s,a=(e=new l(e)).s;if(s!=a)return e.s=-a,i.plus(e);var c=i.c.slice(),d=i.e,f=e.c,h=e.e;if(!c[0]||!f[0])return f[0]?e.s=-a:c[0]?e=new l(i):e.s=1,e;if(s=d-h){for((o=s<0)?(s=-s,n=c):(h=d,n=f),n.reverse(),a=s;a--;)n.push(0);n.reverse()}else for(r=((o=c.length<f.length)?c:f).length,s=a=0;a<r;a++)if(c[a]!=f[a]){o=c[a]<f[a];break}if(o&&(n=c,c=f,f=n,e.s=-e.s),(a=(r=f.length)-(t=c.length))>0)for(;a--;)c[t++]=0;for(a=t;r>s;){if(c[--r]<f[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=f[r]}for(;c[--a]===0;)c.pop();for(;c[0]===0;)c.shift(),--h;return c[0]||(e.s=1,c=[h=0]),e.c=c,e.e=h,e};g.mod=function(e){var t,r=this,n=r.constructor,o=r.s,i=(e=new n(e)).s;if(!e.c[0])throw Error(Re);return r.s=e.s=1,t=e.cmp(r)==1,r.s=o,e.s=i,t?new n(r):(o=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=o,n.RM=i,this.minus(r.times(e)))};g.plus=g.add=function(e){var t,r,n,o=this,i=o.constructor;if(e=new i(e),o.s!=e.s)return e.s=-e.s,o.minus(e);var l=o.e,s=o.c,a=e.e,c=e.c;if(!s[0]||!c[0])return c[0]||(s[0]?e=new i(o):e.s=o.s),e;if(s=s.slice(),t=l-a){for(t>0?(a=l,n=c):(t=-t,n=s),n.reverse();t--;)n.push(0);n.reverse()}for(s.length-c.length<0&&(n=c,c=s,s=n),t=c.length,r=0;t;s[t]%=10)r=(s[--t]=s[t]+c[t]+r)/10|0;for(r&&(s.unshift(r),++a),t=s.length;s[--t]===0;)s.pop();return e.c=s,e.e=a,e};g.pow=function(e){var t=this,r=new t.constructor("1"),n=r,o=e<0;if(e!==~~e||e<-Ee||e>Ee)throw Error(k+"exponent");for(o&&(e=-e);e&1&&(n=n.times(t)),e>>=1,!!e;)t=t.times(t);return o?r.div(n):n};g.prec=function(e,t){if(e!==~~e||e<1||e>N)throw Error(k+"precision");return T(new this.constructor(this),e,t)};g.round=function(e,t){if(e===A)e=0;else if(e!==~~e||e<-N||e>N)throw Error(W);return T(new this.constructor(this),e+this.e+1,t)};g.sqrt=function(){var e,t,r,n=this,o=n.constructor,i=n.s,l=n.e,s=new o("0.5");if(!n.c[0])return new o(n);if(i<0)throw Error(U+"No square root");i=Math.sqrt(n+""),i===0||i===1/0?(t=n.c.join(""),t.length+l&1||(t+="0"),i=Math.sqrt(t),l=((l+1)/2|0)-(l<0||l&1),e=new o((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+l)):e=new o(i+""),l=e.e+(o.DP+=4);do r=e,e=s.times(r.plus(n.div(r)));while(r.c.slice(0,l).join("")!==e.c.slice(0,l).join(""));return T(e,(o.DP-=4)+e.e+1,o.RM)};g.times=g.mul=function(e){var t,r=this,n=r.constructor,o=r.c,i=(e=new n(e)).c,l=o.length,s=i.length,a=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!o[0]||!i[0])return e.c=[e.e=0],e;for(e.e=a+c,l<s&&(t=o,o=i,i=t,c=l,l=s,s=c),t=new Array(c=l+s);c--;)t[c]=0;for(a=s;a--;){for(s=0,c=l+a;c>a;)s=t[c]+i[a]*o[c-a-1]+s,t[c--]=s%10,s=s/10|0;t[c]=s}for(s?++e.e:t.shift(),a=t.length;!t[--a];)t.pop();return e.c=t,e};g.toExponential=function(e,t){var r=this,n=r.c[0];if(e!==A){if(e!==~~e||e<0||e>N)throw Error(W);for(r=T(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return I(r,!0,!!n)};g.toFixed=function(e,t){var r=this,n=r.c[0];if(e!==A){if(e!==~~e||e<0||e>N)throw Error(W);for(r=T(new r.constructor(r),e+r.e+1,t),e=e+r.e+1;r.c.length<e;)r.c.push(0)}return I(r,!1,!!n)};g.toJSON=g.toString=function(){var e=this,t=e.constructor;return I(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])};g.toNumber=function(){var e=Number(I(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(U+"Imprecise conversion");return e};g.toPrecision=function(e,t){var r=this,n=r.constructor,o=r.c[0];if(e!==A){if(e!==~~e||e<1||e>N)throw Error(k+"precision");for(r=T(new n(r),e,t);r.c.length<e;)r.c.push(0)}return I(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!o)};g.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(U+"valueOf disallowed");return I(e,e.e<=t.NE||e.e>=t.PE,!0)};var J=ye();const ct=(e,t)=>J(e).div(t).toNumber();Array.prototype.abs=function(){let e=[...this];for(let t=0;t<this.length;t++)e[t]=Math.abs(this[t]);return e};Array.prototype.max=function(){let e=-1/0;for(let t=0;t<this.length;t++)e=Math.max(this[t],e);return e};Array.prototype.div=function(e){let t=[...this];for(let r=0;r<this.length;r++)t[r]=this[r]/e;return t};const lt=e=>e.replace("\u51B0\u98CE\u8FF7\u9014\u7684\u52C7\u58EB","blizzardStrayer").replace("\u5E73\u606F\u96F7\u9E23\u7684\u5C0A\u8005","thunderSmoother").replace("\u6E21\u8FC7\u70C8\u706B\u7684\u8D24\u4EBA","lavaWalker").replace("\u88AB\u601C\u7231\u7684\u5C11\u5973","maidenBeloved").replace("\u89D2\u6597\u58EB\u7684\u7EC8\u5E55\u793C","gladiatorFinale").replace("\u7FE0\u7EFF\u4E4B\u5F71","viridescentVenerer").replace("\u6D41\u6D6A\u5927\u5730\u7684\u4E50\u56E2","wandererTroupe").replace("\u5982\u96F7\u7684\u76DB\u6012","thunderingFury").replace("\u70BD\u70C8\u7684\u708E\u4E4B\u9B54\u5973","crimsonWitch").replace("\u6614\u65E5\u5B97\u5BA4\u4E4B\u4EEA","noblesseOblige").replace("\u67D3\u8840\u7684\u9A91\u58EB\u9053","bloodstainedChivalry").replace("\u60A0\u53E4\u7684\u78D0\u5CA9","archaicPetra").replace("\u9006\u98DE\u7684\u6D41\u661F","retracingBolide").replace("\u6C89\u6CA6\u4E4B\u5FC3","heartOfDepth").replace("\u5343\u5CA9\u7262\u56FA","tenacityOfTheMillelith").replace("\u82CD\u767D\u4E4B\u706B","paleFlame").replace("\u8FFD\u5FC6\u4E4B\u6CE8\u8FDE","shimenawaReminiscence").replace("\u7EDD\u7F18\u4E4B\u65D7\u5370","emblemOfSeveredFate"),ut=e=>e.replace("\u751F\u4E4B\u82B1","flower").replace("\u6B7B\u4E4B\u7FBD","feather").replace("\u65F6\u4E4B\u6C99","sand").replace("\u7A7A\u4E4B\u676F","cup").replace("\u7406\u4E4B\u51A0","head");function F(e){let t,r;return e.value.includes("%")?(t=e.name.replace("\u653B\u51FB\u529B","attackPercentage").replace("\u9632\u5FA1\u529B","defendPercentage").replace("\u751F\u547D\u503C","lifePercentage").replace("\u66B4\u51FB\u7387","critical").replace("\u66B4\u51FB\u4F24\u5BB3","criticalDamage").replace("\u5143\u7D20\u5145\u80FD\u6548\u7387","recharge").replace("\u6CBB\u7597\u52A0\u6210","cureEffect").replace("\u7269\u7406\u4F24\u5BB3\u52A0\u6210","physicalBonus").replace("\u706B\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","fireBonus").replace("\u96F7\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","thunderBonus").replace("\u51B0\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","iceBonus").replace("\u6C34\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","waterBonus").replace("\u98CE\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","windBonus").replace("\u5CA9\u5143\u7D20\u4F24\u5BB3\u52A0\u6210","rockBonus"),r=ct(e.value.replace("%",""),100)):(t=e.name.replace("\u653B\u51FB\u529B","attackStatic").replace("\u9632\u5FA1\u529B","defendStatic").replace("\u751F\u547D\u503C","lifeStatic").replace("\u5143\u7D20\u7CBE\u901A","elementalMastery"),r=Number(e.value)),{name:t,value:r}}const rr=e=>{let t={flower:[],feather:[],sand:[],cup:[],head:[]},r=0;return e.forEach(n=>{let o={setName:lt(n.alternative),position:ut(n.part),mainTag:F(n.main),normalTags:[F(n.second1),F(n.second2),F(n.second3),F(n.second4)],omit:!1,star:5,level:20,id:r++};t[o.position].push(o)}),t};var v,Me;const ft=(Me=class{constructor(e){ae(this,v,void 0);ce(this,v,e)}toFile(){switch(_(this,v).constructor.name){case"File":return new File([_(this,v)],"");case"HTMLCanvasElement":return new File([new Uint8Array(atob(_(this,v).toDataURL().split(",")[1]).split("").map(e=>e.charCodeAt()))],"")}}toURL(){switch(_(this,v).constructor.name){case"File":return URL.createObjectURL(_(this,v));case"HTMLCanvasElement":return _(this,v).toDataURL()}}toBuffer(){switch(_(this,v).constructor.name){case"ArrayBuffer":return _(this,v).slice();case"File":return new Promise(e=>{const t=new FileReader;t.onload=()=>e(t.result),t.readAsArrayBuffer(_(this,v))})}}toCanvas(){switch(_(this,v).constructor.name){case"File":return new Promise(e=>{const t=new Image;t.onload=()=>{const r=document.createElement("canvas");r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),e(r)},t.src=URL.createObjectURL(_(this,v))});case"HTMLCanvasElement":return(()=>{const e=document.createElement("canvas");return e.width=_(this,v).width,e.height=_(this,v).height,e.getContext("2d").drawImage(_(this,v),0,0),e})()}}},v=new WeakMap,Me),nr=async e=>{let t=await e.toBuffer(),r=Oe({MEMFS:[{name:"input.mp4",data:t}],arguments:["-i","input.mp4","output.mp3"]});return new ft(r.MEMFS[0].data.buffer)},or=async(e,t)=>{const r=new(window.AudioContext||window.webkitAudioContext),n=await e.toBuffer(),o=await new Promise(s=>r.decodeAudioData(n,s));return((s,a)=>{const c=[];for(let d=0;d<s.length/a;d++){let f=0;const h=d*a,p=Math.min(h+a,s.length);for(let w=h;w<p;w++)f=Math.max(s[w],f);c.push(f)}return c})((s=>{let a=[...s].abs();return a.div(a.max())})(o.getChannelData(0)),o.sampleRate/t)},ir=(e,t)=>{let r=[],n=[];for(let o=0;o<e.length;o++)e[o]>=.5?n.push(o):n[0]&&(r.push(~~(n.reduce((i,l)=>i+l)/n.length)/t),n=[]);return r},sr=(e,t)=>new Promise(r=>{let n=0;const o=[],i=document.createElement("video");i.addEventListener("loadeddata",()=>i.currentTime=t[n]),i.addEventListener("seeked",()=>{if(n<t.length){const l=document.createElement("canvas");l.width=i.videoWidth,l.height=i.videoHeight,requestAnimationFrame(()=>{l.getContext("2d").drawImage(i,0,0,i.videoWidth,i.videoHeight),o.push(l),i.currentTime=t[n=n+1]||0})}else r(o)}),i.playsInline=!0,i.src=e.toURL(),i.play(),i.pause()}),O=(e,t,r,n,o)=>{const i=document.createElement("canvas");return i.width=n,i.height=o,i.getContext("2d").drawImage(e,t,r,n,o,0,0,n,o),i};window.cv=u;const ar=e=>{let t=(()=>{let n=u.imread(e),o=new u.MatVector,i=new u.Mat;u.cvtColor(n,n,u.COLOR_RGB2GRAY),u.threshold(n,n,0,255,u.THRESH_TRIANGLE),u.findContours(n,o,i,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let l=[];for(let a=0;a<o.size();a++)l.push(u.contourArea(o.get(a)));let s=u.boundingRect(o.get(l.indexOf(Math.max(...l))));return n.delete(),o.delete(),i.delete(),s})(),r=(()=>{let n=u.imread(e).roi(new u.Rect(t.x,0,t.width,t.y)),o=new u.MatVector,i=new u.Mat;u.cvtColor(n,n,u.COLOR_RGB2GRAY),u.threshold(n,n,100,255,u.THRESH_BINARY),u.findContours(n,o,i,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let l=null;for(let s=0;s<o.size();s++){let a=u.boundingRect(o.get(s));a.width==t.width&&(l=a)}return n.delete(),o.delete(),i.delete(),l})();return[t.x,r.y,t.width,t.y+t.height-r.y]},dt=e=>{let t=(()=>{let i=u.imread(e.toCanvas()),l=new u.MatVector,s=new u.Mat;u.cvtColor(i,i,u.COLOR_RGB2GRAY),u.threshold(i,i,0,255,u.THRESH_TRIANGLE),u.findContours(i,l,s,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let a=[];for(let d=0;d<l.size();d++)a.push(u.contourArea(l.get(d)));let c=u.boundingRect(l.get(a.indexOf(Math.max(...a))));return i.delete(),l.delete(),s.delete(),c})(),r=(()=>{let i=u.imread(e.toCanvas()).roi(new u.Rect(t.x,t.y,t.width,t.height)),l=u.Mat.ones(8,16,u.CV_8U),s=new u.Mat(i.rows,i.cols,u.CV_8UC3,[35,43,46,0]),a=new u.Mat(i.rows,i.cols,u.CV_8UC3,[77,255,255,0]),c=new u.MatVector,d=new u.Mat;u.erode(i,i,l),u.cvtColor(i,i,u.COLOR_RGB2HSV),u.inRange(i,s,a,i),u.findContours(i,c,d,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let f=[];for(let p=0;p<c.size();p++)f.push(u.contourArea(c.get(p)));let h=u.boundingRect(c.get(f.indexOf(Math.max(...f))));return i.delete(),l.delete(),s.delete(),a.delete(),c.delete(),d.delete(),h})(),n=(()=>{let i=u.imread(e.toCanvas()).roi(new u.Rect(t.x,t.y,t.width,r.y)),l=u.Mat.ones(8,16,u.CV_8U),s=new u.MatVector,a=new u.Mat;u.erode(i,i,l),u.cvtColor(i,i,u.COLOR_RGB2GRAY),u.threshold(i,i,0,255,u.THRESH_OTSU),u.bitwise_not(i,i),u.findContours(i,s,a,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let c=[];for(let f=0;f<s.size();f++)c.push(u.boundingRect(s.get(f)));let d=[0,t.width/2];return i.delete(),l.delete(),s.delete(),a.delete(),c.filter(f=>f.x>d[0]&&f.x<d[1]).sort((f,h)=>f.y-h.y)})(),o=(()=>{let i=u.imread(e.toCanvas()).roi(new u.Rect(t.x,0,t.width,t.y)),l=u.Mat.ones(8,16,u.CV_8U),s=new u.MatVector,a=new u.Mat;u.dilate(i,i,l),u.cvtColor(i,i,u.COLOR_RGB2GRAY),u.threshold(i,i,0,255,u.THRESH_OTSU),u.findContours(i,s,a,u.RETR_EXTERNAL,u.CHAIN_APPROX_SIMPLE);let c=[];for(let f=0;f<s.size();f++)c.push(u.boundingRect(s.get(f)));let d=[0,t.width/2];return i.delete(),l.delete(),s.delete(),a.delete(),c.filter(f=>f.x>d[0]&&f.x<d[1]).sort((f,h)=>f.y-h.y)})();return{part:[o[1].x-3,o[1].y-3,o[1].width+3,o[1].height+3],main1:[o[2].x-3,o[2].y-3,o[2].width+3,o[2].height+3],main2:[o[3].x-3,o[3].y-3,o[3].width+3,o[3].height+3],second:n.slice(1).map(i=>[i.x-3,t.y+i.y-3,i.width+3,i.height+3]),alternative:[r.x-3,t.y+r.y-3,r.width+3,r.height+3]}};class ht{constructor(){let t="123456789.0%+\u751F\u4E4B\u82B1\u6B7B\u7FBD\u65F6\u6C99\u7A7A\u676F\u7406\u51A0\u9632\u5FA1\u529B\u547D\u503C\u653B\u51FB\u5CA9\u5143\u7D20\u4F24\u5BB3\u52A0\u6210\u6C34\u96F7\u98CE\u706B\u51B0\u7269\u5145\u80FD\u6548\u7387\u66B4\u6CBB\u7597\u7CBE\u901A\u8FF7\u9014\u7684\u52C7\u58EB\u5E73\u606F\u9E23\u5C0A\u8005\u6E21\u8FC7\u70C8\u8D24\u4EBA\u88AB\u601C\u7231\u5C11\u5973\u89D2\u6597\u7EC8\u5E55\u793C\u7FE0\u7EFF\u5F71\u6D41\u6D6A\u5927\u5730\u4E50\u56E2\u5982\u76DB\u6012\u70BD\u708E\u9B54\u6614\u65E5\u5B97\u5BA4\u4EEA\u67D3\u8840\u9A91\u9053\u60A0\u53E4\u78D0\u9006\u98DE\u661F\u6C89\u6CA6\u5FC3\u5343\u7262\u56FA\u82CD\u767D\u8FFD\u5FC6\u6CE8\u8FDE\u7EDD\u7F18\u65D7\u5370";this.encode_table=r=>r.map(n=>t.indexOf(n)+1),this.decode_table=r=>r.map(n=>t[n-1]||"")}removeRepetition(t){let r=[];for(let n in t)t[n]!=t[n-1]&&r.push(t[n]);return r}decode(t){return t.argMax(2).arraySync().map(this.removeRepetition).map(this.decode_table).map(r=>r.join(""))}}const C=(e,t)=>{let r=u.imread(e);u.cvtColor(r,r,u.COLOR_RGBA2GRAY),u.blur(r,r,new u.Size(3,3));let n=Math.min(...r.data);r.data.map((h,p)=>r.data[p]=r.data[p]-n);let o=Math.max(...r.data);r.data.map((h,p)=>r.data[p]=r.data[p]/o*255),r.data[r.data.length-1]>=127.5&&r.data.map((h,p)=>r.data[p]=255-r.data[p]);let i=new u.Mat;u.threshold(r,i,0,255,u.THRESH_OTSU),i=Ce(i.data,[i.rows,i.cols],"bool");let[l,s]=[i.any(0),i.any(1)],a=l.argMax().arraySync();if(t){let h=l.arraySync().slice(a).indexOf(0),p=l.arraySync().slice(a+h).indexOf(1);a=a+h+p}let c=s.argMax().arraySync(),d=r.cols-l.reverse().argMax().arraySync()-a,f=r.rows-s.reverse().argMax().arraySync()-c;return r=r.roi(new u.Rect(a,c,d,f)),u.resize(r,r,new u.Size(16/r.rows*r.cols,16),0,0,u.INTER_LINEAR),u.copyMakeBorder(r,r,0,0,0,192-r.cols,u.BORDER_CONSTANT),[...r.data].map(h=>h/255)};let oe=null,ie=null;const pt=async e=>{oe||(oe=new ht),ie||(ie=await Pe("modelfiles/model.json"));let t=ie.predict(Se(e.flat(),[e.length,16,192,1]));return oe.decode(t)},cr=async e=>{const t=p=>({name:(p.split("+")[0]||"").replace(/[^攻击力生命值防御元素充能效率暴伤害精通]/g,""),value:(p.split("+")[1]||"").replace(/[^123456789.0%]/g,"")}),r=dt(e);let n=C(O(e.toCanvas(),...r.part)),o=C(O(e.toCanvas(),...r.main1)),i=C(O(e.toCanvas(),...r.main2)),l=C(O(e.toCanvas(),...r.second[0]),!0),s=C(O(e.toCanvas(),...r.second[1]),!0),a=C(O(e.toCanvas(),...r.second[2]),!0),c=C(O(e.toCanvas(),...r.second[3]),!0),d=C(O(e.toCanvas(),...r.alternative));return[n,o,i,l,s,a,c,d]=await pt([n,o,i,l,s,a,c,d]),{part:n.replace(/[^生之花死羽时沙空杯理冠]/g,""),main:{name:o.replace(/[^防御力生命值攻击岩元素伤害加成水雷风火冰物理充能效率暴治疗精通]/g,""),value:i.replace(/[^123456789.0%]/g,"")},second1:t(l),second2:t(s),second3:t(a),second4:t(c),alternative:d.replace(/[^冰风迷途的勇士平息鸣雷尊者渡过烈火贤人被怜爱少女角斗终幕礼翠绿之影流浪大地乐团如盛怒炽炎魔昔日宗室仪染血骑道悠古磐岩逆飞星沉沦心千牢固苍白追忆注连绝缘旗印]/g,"")}},R=(e,t)=>J(e).plus(t).toNumber(),L=(e,t)=>J(e).times(t).toNumber(),gt=(...e)=>e.reduce((t,r)=>t.times(r),J(1)).toNumber();let x={flower:{\u751F\u547D\u503C:4780},feather:{\u653B\u51FB\u529B:311},sand:{"\u653B\u51FB\u529B%":.466},cup:{"\u653B\u51FB\u529B%":.466,\u5CA9\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u6C34\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u96F7\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u98CE\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u706B\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u51B0\u5143\u7D20\u4F24\u5BB3\u52A0\u6210:.466,\u7269\u7406\u4F24\u5BB3\u52A0\u6210:.583},head:{"\u653B\u51FB\u529B%":.466,\u66B4\u51FB\u7387:.311,\u66B4\u51FB\u4F24\u5BB3:.622},second:{"\u653B\u51FB\u529B%":.058,\u66B4\u51FB\u7387:.039,\u66B4\u51FB\u4F24\u5BB3:.078,\u653B\u51FB\u529B:19}},xe=(e,t,r,n,o,i,l,s)=>{let a=R(L(R(e,t),R(1,r)),n),c=o,d=R(1,i),f=R(1,L(Math.min(l,1),s));return gt(a,c,d,f)},mt=(...e)=>e.reduce((t,r)=>{const n=[];return t.forEach(o=>r.forEach(i=>n.push([...o,i]))),n},[[]]),Ae=e=>{var t={};for(var r of Object.values(e))for(var[n,o]of Object.entries(r))t[n]=(t[n]||0)+o;return t},wt=mt(Object.entries(x.flower),Object.entries(x.feather),Object.entries(x.sand),Object.entries(x.cup),Object.entries(x.head));function vt(e,t){var r={flower:{},feather:{},sand:{},cup:{},head:{}};t=t.replace("phys","\u7269\u7406\u4F24\u5BB3\u52A0\u6210").replace("\u96F7","\u96F7\u5143\u7D20\u4F24\u5BB3\u52A0\u6210").replace("\u5CA9","\u5CA9\u5143\u7D20\u4F24\u5BB3\u52A0\u6210").replace("\u98CE","\u98CE\u5143\u7D20\u4F24\u5BB3\u52A0\u6210").replace("\u6C34","\u6C34\u5143\u7D20\u4F24\u5BB3\u52A0\u6210").replace("\u706B","\u706B\u5143\u7D20\u4F24\u5BB3\u52A0\u6210");function n(){function a(c){var d=JSON.parse(JSON.stringify(r));for(var f in d){const w=d[f],m=Object.values(w);if((m.length==4?w[c]:!w[c])&&(w[c]||0)<6&&m.reduce((b,y)=>b+y,0)<9){w[c]=(w[c]||0)+1;break}}var h=Ae(d),p=xe(e.\u89D2\u8272\u653B\u51FB\u529B||0,e.\u6B66\u5668\u653B\u51FB\u529B||0,R(L(x.second["\u653B\u51FB\u529B%"],h["\u653B\u51FB\u529B%"]||0),e["\u653B\u51FB\u529B%"]||0),R(L(x.second.\u653B\u51FB\u529B,h.\u653B\u51FB\u529B||0),e.\u653B\u51FB\u529B||0),e.\u6280\u80FD\u500D\u7387||0,e[t]||0,R(L(x.second.\u66B4\u51FB\u7387,h.\u66B4\u51FB\u7387||0),e.\u66B4\u51FB\u7387||0),R(L(x.second.\u66B4\u51FB\u4F24\u5BB3,h.\u66B4\u51FB\u4F24\u5BB3||0),e.\u66B4\u51FB\u4F24\u5BB3||0));return[p,()=>r=d]}Object.keys(x.second).map(a).sort((c,d)=>d[0]-c[0])[0][1]()}for(var o=0;o<45;o++)n();for(var[i,l]of Object.entries(Ae(r)))e[i]=R(e[i]||0,L(x.second[i],l));var s=xe(e.\u89D2\u8272\u653B\u51FB\u529B||0,e.\u6B66\u5668\u653B\u51FB\u529B||0,e["\u653B\u51FB\u529B%"]||0,e.\u653B\u51FB\u529B||0,e.\u6280\u80FD\u500D\u7387||0,e[t]||0,e.\u66B4\u51FB\u7387||0,e.\u66B4\u51FB\u4F24\u5BB3||0);return[s,e]}const lr=(e,t,r,n,o)=>{let i=[];for(let a of wt){let c={\u89D2\u8272\u653B\u51FB\u529B:t,\u6B66\u5668\u653B\u51FB\u529B:r,\u6280\u80FD\u500D\u7387:n};for(var[l,s]of o)c[l]=R(c[l]||0,s);for(var[l,s]of a)c[l]=R(c[l]||0,s);i.push(vt(c,e))}return[...i].sort((a,c)=>c[0]-a[0])[0]};export{ar as $,qe as A,ke as B,It as C,ze as D,Gt as E,Ge as F,Kt as G,Vt as H,we as I,Ct as J,O as K,Dt as L,ft as M,dt as N,zt as O,qt as P,Ft as Q,er as R,Jt as S,tr as T,Ot as U,Zt as V,cr as W,nr as X,or as Y,ir as Z,sr as _,le as a,lr as a0,Tt as b,De as c,$t as d,St as e,Pt as f,Xt as g,$e as h,Wt as i,Mt as j,kt as k,Lt as l,xt as m,P as n,Nt as o,Ht as p,Bt as q,Ut as r,Te as s,ge as t,jt as u,D as v,At as w,Qt as x,rr as y,Yt as z};
