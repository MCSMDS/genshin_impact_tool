var e,t,r=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},n=(e,t,n)=>(r(e,t,"read from private field"),n?n.call(e):t.get(e));import{f as o}from"./ffmpeg.f969c7f1.js";import{t as a,l as s,a as i}from"./vendor.bddd418e.js";import{c}from"./opencv.be337fbb.js";function l(){}const u=e=>e;function f(e,t){for(const r in t)e[r]=t[r];return e}function d(e){return e()}function h(){return Object.create(null)}function p(e){e.forEach(d)}function m(e){return"function"==typeof e}function g(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let w;function v(e,t){return w||(w=document.createElement("a")),w.href=t,e===w.href}function b(e,t,r){e.$$.on_destroy.push(function(e,...t){if(null==e)return l;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}(t,r))}function y(e){const t={};for(const r in e)"$"!==r[0]&&(t[r]=e[r]);return t}function E(e){return null==e?"":e}function R(e,t,r){return e.set(r),t}const C="undefined"!=typeof window;let A=C?()=>window.performance.now():()=>Date.now(),_=C?e=>requestAnimationFrame(e):l;const x=new Set;function M(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&_(M)}function O(e,t){e.appendChild(t)}function N(e,t,r){e.insertBefore(t,r||null)}function S(e){e.parentNode.removeChild(e)}function $(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function P(e){return document.createElement(e)}function T(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function j(){return L(" ")}function H(){return L("")}function I(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function B(e){return function(t){return t.preventDefault(),e.call(this,t)}}function k(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function D(e,t){for(const r in t)k(e,r,t[r])}function U(e){return""===e?null:+e}function z(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function F(e,t){e.value=null==t?"":t}function G(e,t,r){e.classList[r?"add":"remove"](t)}let V;function X(e){V=e}function q(e,t){const r=e.$$.callbacks[t.type];r&&r.slice().forEach((e=>e.call(this,t)))}const Y=[],W=[],J=[],K=[],Q=Promise.resolve();let Z=!1;function ee(e){J.push(e)}let te=!1;const re=new Set;function ne(){if(!te){te=!0;do{for(let e=0;e<Y.length;e+=1){const t=Y[e];X(t),oe(t.$$)}for(X(null),Y.length=0;W.length;)W.pop()();for(let e=0;e<J.length;e+=1){const t=J[e];re.has(t)||(re.add(t),t())}J.length=0}while(Y.length);for(;K.length;)K.pop()();Z=!1,te=!1,re.clear()}}function oe(e){if(null!==e.fragment){e.update(),p(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ee)}}const ae=new Set;let se;function ie(){se={r:0,c:[],p:se}}function ce(){se.r||p(se.c),se=se.p}function le(e,t){e&&e.i&&(ae.delete(e),e.i(t))}function ue(e,t,r,n){if(e&&e.o){if(ae.has(e))return;ae.add(e),se.c.push((()=>{ae.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}}function fe(e,t){const r={},n={},o={$$scope:1};let a=e.length;for(;a--;){const s=e[a],i=t[a];if(i){for(const e in s)e in i||(n[e]=1);for(const e in i)o[e]||(r[e]=i[e],o[e]=1);e[a]=i}else for(const e in s)o[e]=1}for(const s in n)s in r||(r[s]=void 0);return r}function de(e){e&&e.c()}function he(e,t,r,n){const{fragment:o,on_mount:a,on_destroy:s,after_update:i}=e.$$;o&&o.m(t,r),n||ee((()=>{const t=a.map(d).filter(m);s?s.push(...t):p(t),e.$$.on_mount=[]})),i.forEach(ee)}function pe(e,t){const r=e.$$;null!==r.fragment&&(p(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function me(e,t){-1===e.$$.dirty[0]&&(Y.push(e),Z||(Z=!0,Q.then(ne)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(e,t,r,n,o,a,s,i=[-1]){const c=V;X(e);const u=e.$$={fragment:null,ctx:null,props:a,update:l,not_equal:o,bound:h(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:h(),dirty:i,skip_bound:!1,root:t.target||c.$$.root};s&&s(u.root);let f=!1;if(u.ctx=r?r(e,t.props||{},((t,r,...n)=>{const a=n.length?n[0]:r;return u.ctx&&o(u.ctx[t],u.ctx[t]=a)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](a),f&&me(e,t)),r})):[],u.update(),f=!0,p(u.before_update),u.fragment=!!n&&n(u.ctx),t.target){if(t.hydrate){const e=(d=t.target,Array.from(d.childNodes));u.fragment&&u.fragment.l(e),e.forEach(S)}else u.fragment&&u.fragment.c();t.intro&&le(e.$$.fragment),he(e,t.target,t.anchor,t.customElement),ne()}var d;X(c)}class we{$destroy(){pe(this,1),this.$destroy=l}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var ve="[big.js] ",be=ve+"Invalid ",ye=be+"decimal places",Ee={},Re=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Ce(e,t,r,n){var o=e.c;if(undefined===r&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error("[big.js] Invalid rounding mode");if(t<1)n=3===r&&(n||!!o[0])||0===t&&(1===r&&o[0]>=5||2===r&&(o[0]>5||5===o[0]&&(n||undefined!==o[1]))),o.length=1,n?(e.e=e.e-t+1,o[0]=1):o[0]=e.e=0;else if(t<o.length){if(n=1===r&&o[t]>=5||2===r&&(o[t]>5||5===o[t]&&(n||undefined!==o[t+1]||1&o[t-1]))||3===r&&(n||!!o[0]),o.length=t--,n)for(;++o[t]>9;)o[t]=0,t--||(++e.e,o.unshift(1));for(t=o.length;!o[--t];)o.pop()}return e}function Ae(e,t,r){var n=e.e,o=e.c.join(""),a=o.length;if(t)o=o.charAt(0)+(a>1?"."+o.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)o="0"+o;o="0."+o}else if(n>0)if(++n>a)for(n-=a;n--;)o+="0";else n<a&&(o=o.slice(0,n)+"."+o.slice(n));else a>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&r?"-"+o:o}Ee.abs=function(){var e=new this.constructor(this);return e.s=1,e},Ee.cmp=function(e){var t,r=this,n=r.c,o=(e=new r.constructor(e)).c,a=r.s,s=e.s,i=r.e,c=e.e;if(!n[0]||!o[0])return n[0]?a:o[0]?-s:0;if(a!=s)return a;if(t=a<0,i!=c)return i>c^t?1:-1;for(s=(i=n.length)<(c=o.length)?i:c,a=-1;++a<s;)if(n[a]!=o[a])return n[a]>o[a]^t?1:-1;return i==c?0:i>c^t?1:-1},Ee.div=function(e){var t=this,r=t.constructor,n=t.c,o=(e=new r(e)).c,a=t.s==e.s?1:-1,s=r.DP;if(s!==~~s||s<0||s>1e6)throw Error(ye);if(!o[0])throw Error("[big.js] Division by zero");if(!n[0])return e.s=a,e.c=[e.e=0],e;var i,c,l,u,f,d=o.slice(),h=i=o.length,p=n.length,m=n.slice(0,i),g=m.length,w=e,v=w.c=[],b=0,y=s+(w.e=t.e-e.e)+1;for(w.s=a,a=y<0?0:y,d.unshift(0);g++<i;)m.push(0);do{for(l=0;l<10;l++){if(i!=(g=m.length))u=i>g?1:-1;else for(f=-1,u=0;++f<i;)if(o[f]!=m[f]){u=o[f]>m[f]?1:-1;break}if(!(u<0))break;for(c=g==i?o:d;g;){if(m[--g]<c[g]){for(f=g;f&&!m[--f];)m[f]=9;--m[f],m[g]+=10}m[g]-=c[g]}for(;!m[0];)m.shift()}v[b++]=u?l:++l,m[0]&&u?m[g]=n[h]||0:m=[n[h]]}while((h++<p||undefined!==m[0])&&a--);return v[0]||1==b||(v.shift(),w.e--,y--),b>y&&Ce(w,y,r.RM,undefined!==m[0]),w},Ee.eq=function(e){return 0===this.cmp(e)},Ee.gt=function(e){return this.cmp(e)>0},Ee.gte=function(e){return this.cmp(e)>-1},Ee.lt=function(e){return this.cmp(e)<0},Ee.lte=function(e){return this.cmp(e)<1},Ee.minus=Ee.sub=function(e){var t,r,n,o,a=this,s=a.constructor,i=a.s,c=(e=new s(e)).s;if(i!=c)return e.s=-c,a.plus(e);var l=a.c.slice(),u=a.e,f=e.c,d=e.e;if(!l[0]||!f[0])return f[0]?e.s=-c:l[0]?e=new s(a):e.s=1,e;if(i=u-d){for((o=i<0)?(i=-i,n=l):(d=u,n=f),n.reverse(),c=i;c--;)n.push(0);n.reverse()}else for(r=((o=l.length<f.length)?l:f).length,i=c=0;c<r;c++)if(l[c]!=f[c]){o=l[c]<f[c];break}if(o&&(n=l,l=f,f=n,e.s=-e.s),(c=(r=f.length)-(t=l.length))>0)for(;c--;)l[t++]=0;for(c=t;r>i;){if(l[--r]<f[r]){for(t=r;t&&!l[--t];)l[t]=9;--l[t],l[r]+=10}l[r]-=f[r]}for(;0===l[--c];)l.pop();for(;0===l[0];)l.shift(),--d;return l[0]||(e.s=1,l=[d=0]),e.c=l,e.e=d,e},Ee.mod=function(e){var t,r=this,n=r.constructor,o=r.s,a=(e=new n(e)).s;if(!e.c[0])throw Error("[big.js] Division by zero");return r.s=e.s=1,t=1==e.cmp(r),r.s=o,e.s=a,t?new n(r):(o=n.DP,a=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=o,n.RM=a,this.minus(r.times(e)))},Ee.plus=Ee.add=function(e){var t,r,n,o=this,a=o.constructor;if(e=new a(e),o.s!=e.s)return e.s=-e.s,o.minus(e);var s=o.e,i=o.c,c=e.e,l=e.c;if(!i[0]||!l[0])return l[0]||(i[0]?e=new a(o):e.s=o.s),e;if(i=i.slice(),t=s-c){for(t>0?(c=s,n=l):(t=-t,n=i),n.reverse();t--;)n.push(0);n.reverse()}for(i.length-l.length<0&&(n=l,l=i,i=n),t=l.length,r=0;t;i[t]%=10)r=(i[--t]=i[t]+l[t]+r)/10|0;for(r&&(i.unshift(r),++c),t=i.length;0===i[--t];)i.pop();return e.c=i,e.e=c,e},Ee.pow=function(e){var t=this,r=new t.constructor("1"),n=r,o=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(be+"exponent");for(o&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return o?r.div(n):n},Ee.prec=function(e,t){if(e!==~~e||e<1||e>1e6)throw Error(be+"precision");return Ce(new this.constructor(this),e,t)},Ee.round=function(e,t){if(undefined===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(ye);return Ce(new this.constructor(this),e+this.e+1,t)},Ee.sqrt=function(){var e,t,r,n=this,o=n.constructor,a=n.s,s=n.e,i=new o("0.5");if(!n.c[0])return new o(n);if(a<0)throw Error(ve+"No square root");0===(a=Math.sqrt(n+""))||a===1/0?((t=n.c.join("")).length+s&1||(t+="0"),s=((s+1)/2|0)-(s<0||1&s),e=new o(((a=Math.sqrt(t))==1/0?"5e":(a=a.toExponential()).slice(0,a.indexOf("e")+1))+s)):e=new o(a+""),s=e.e+(o.DP+=4);do{r=e,e=i.times(r.plus(n.div(r)))}while(r.c.slice(0,s).join("")!==e.c.slice(0,s).join(""));return Ce(e,(o.DP-=4)+e.e+1,o.RM)},Ee.times=Ee.mul=function(e){var t,r=this,n=r.constructor,o=r.c,a=(e=new n(e)).c,s=o.length,i=a.length,c=r.e,l=e.e;if(e.s=r.s==e.s?1:-1,!o[0]||!a[0])return e.c=[e.e=0],e;for(e.e=c+l,s<i&&(t=o,o=a,a=t,l=s,s=i,i=l),t=new Array(l=s+i);l--;)t[l]=0;for(c=i;c--;){for(i=0,l=s+c;l>c;)i=t[l]+a[c]*o[l-c-1]+i,t[l--]=i%10,i=i/10|0;t[l]=i}for(i?++e.e:t.shift(),c=t.length;!t[--c];)t.pop();return e.c=t,e},Ee.toExponential=function(e,t){var r=this,n=r.c[0];if(undefined!==e){if(e!==~~e||e<0||e>1e6)throw Error(ye);for(r=Ce(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return Ae(r,!0,!!n)},Ee.toFixed=function(e,t){var r=this,n=r.c[0];if(undefined!==e){if(e!==~~e||e<0||e>1e6)throw Error(ye);for(e=e+(r=Ce(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return Ae(r,!1,!!n)},Ee.toJSON=Ee.toString=function(){var e=this,t=e.constructor;return Ae(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},Ee.toNumber=function(){var e=Number(Ae(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(ve+"Imprecise conversion");return e},Ee.toPrecision=function(e,t){var r=this,n=r.constructor,o=r.c[0];if(undefined!==e){if(e!==~~e||e<1||e>1e6)throw Error(be+"precision");for(r=Ce(new n(r),e,t);r.c.length<e;)r.c.push(0)}return Ae(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!o)},Ee.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(ve+"valueOf disallowed");return Ae(e,e.e<=t.NE||e.e>=t.PE,!0)};var _e=function e(){function t(r){var n=this;if(!(n instanceof t))return undefined===r?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict)throw TypeError(be+"number");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,n,o;if(!Re.test(t))throw Error(be+"number");e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".",""));(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length);for(o=t.length,n=0;n<o&&"0"==t.charAt(n);)++n;if(n==o)e.c=[e.e=0];else{for(;o>0&&"0"==t.charAt(--o););for(e.e=r-n-1,e.c=[],r=0;n<=o;)e.c[r++]=+t.charAt(n++)}}(n,r)}n.constructor=t}return t.prototype=Ee,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=false,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();const xe=(...e)=>e.reduce(((e,t)=>e.plus(t)),_e(0)).toNumber(),Me=(e,t)=>_e(e).plus(t).toNumber(),Oe=(e,t)=>_e(e).minus(t).toNumber();Array.prototype.abs=function(){let e=[...this];for(let t=0;t<this.length;t++)e[t]=Math.abs(this[t]);return e},Array.prototype.max=function(){let e=-1/0;for(let t=0;t<this.length;t++)e=Math.max(this[t],e);return e},Array.prototype.div=function(e){let t=[...this];for(let r=0;r<this.length;r++)t[r]=this[r]/e;return t};const Ne=[[4.1,4.7,5.3,5.8],[4.1,4.7,5.3,5.8],[5.1,5.8,6.6,7.3],[4.5,5.2,5.8,6.5],[2.7,3.1,3.5,3.9],[5.4,6.2,7,7.8],[14,16,18,19],[209,239,269,299],[16,19,21,23],[16,19,21,23]];const Se=e=>{var t;e.value.includes("%")?t={"防御力":58.3,"生命值":46.6,"攻击力":46.6,"岩元素伤害加成":46.6,"水元素伤害加成":46.6,"雷元素伤害加成":46.6,"风元素伤害加成":46.6,"火元素伤害加成":46.6,"冰元素伤害加成":46.6,"物理伤害加成":58.3,"元素充能效率":51.8,"暴击率":31.1,"暴击伤害":62.2,"治疗加成":35.9}[e.name]:t={"生命值":4780,"攻击力":311,"元素精通":187}[e.name];return t==e.value.replace("%","")},$e=e=>{const t=e=>4==Ne[e].length?Ne[e]=function(e){let t=[];for(let r of e)for(let n of e)for(let o of e)for(let a of e)for(let s of e)for(let i of e)t.push(xe(r)),t.push(xe(r,n)),t.push(xe(r,n,o)),t.push(xe(r,n,o,a)),t.push(xe(r,n,o,a,s)),t.push(xe(r,n,o,a,s,i));return t}(Ne[e]):Ne[e],r=(e,t)=>e.includes(t);if(e.value.includes("%")){if(null==(a={"攻击力":0,"生命值":1,"防御力":2,"元素充能效率":3,"暴击率":4,"暴击伤害":5})[e.name])return!1;var n=t(a[e.name]),o=Number(e.value.replace("%",""));return!isNaN(o)&&(r(n,o)||r(n,Me(o,.1))||r(n,Oe(o,.1)))}var a;if(null==(a={"攻击力":6,"生命值":7,"防御力":8,"元素精通":9})[e.name])return!1;n=t(a[e.name]),o=Number(e.value.replace("%",""));return!isNaN(o)&&(r(n,o)||r(n,Me(o,1))||r(n,Oe(o,1)))},Pe=e=>{return[(r=e.part,["生之花","死之羽","时之沙","空之杯","理之冠"].includes(r)),Se(e.main),$e(e.second1),$e(e.second2),$e(e.second3),$e(e.second4),(t=e.alternative,["冰风迷途的勇士","平息鸣雷的尊者","渡过烈火的贤人","被怜爱的少女","角斗士的终幕礼","翠绿之影","流浪大地的乐团","如雷的盛怒","炽烈的炎之魔女","昔日宗室之仪","染血的骑士道","悠古的磐岩","逆飞的流星","沉沦之心","千岩牢固","苍白之火","追忆之注连","绝缘之旗印"].includes(t))];var t,r},Te=[];function Le(e,t=l){let r;const n=new Set;function o(t){if(g(e,t)&&(e=t,r)){const t=!Te.length;for(const r of n)r[1](),Te.push(r,e);if(t){for(let e=0;e<Te.length;e+=2)Te[e][0](Te[e+1]);Te.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(a,s=l){const i=[a,s];return n.add(i),1===n.size&&(r=t(o)||l),a(e),()=>{n.delete(i),0===n.size&&(r(),r=null)}}}}function je(e){return"[object Date]"===Object.prototype.toString.call(e)}function He(e,t){if(e===t||e!=e)return()=>e;const r=typeof e;if(r!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const r=t.map(((t,r)=>He(e[r],t)));return e=>r.map((t=>t(e)))}if("object"===r){if(!e||!t)throw new Error("Object cannot be null");if(je(e)&&je(t)){e=e.getTime();const r=(t=t.getTime())-e;return t=>new Date(e+t*r)}const r=Object.keys(t),n={};return r.forEach((r=>{n[r]=He(e[r],t[r])})),e=>{const t={};return r.forEach((r=>{t[r]=n[r](e)})),t}}if("number"===r){const r=t-e;return t=>e+t*r}throw new Error(`Cannot interpolate ${r} values`)}const Ie={video:Le(),images:Le(),setting:{x:Le(),y:Le(),width:Le(),height:Le()}},Be=Le(),ke=Le(),De=function(e,t={}){const r=Le(e);let n,o=e;function a(a,s){if(null==e)return r.set(e=a),Promise.resolve();o=a;let i=n,c=!1,{delay:l=0,duration:d=400,easing:h=u,interpolate:p=He}=f(f({},t),s);if(0===d)return i&&(i.abort(),i=null),r.set(e=o),Promise.resolve();const m=A()+l;let g;return n=function(e){let t;return 0===x.size&&_(M),{promise:new Promise((r=>{x.add(t={c:e,f:r})})),abort(){x.delete(t)}}}((t=>{if(t<m)return!0;c||(g=p(e,a),"function"==typeof d&&(d=d(e,a)),c=!0),i&&(i.abort(),i=null);const n=t-m;return n>d?(r.set(e=a),!1):(r.set(e=g(h(n/d))),!0)})),n.promise}return{set:a,update:(t,r)=>a(t(o,e),r),subscribe:r.subscribe}}(0,{duration:1e3,easing:function(e){const t=e-1;return t*t*t+1}});function Ue(e){let t,r;var n,o;return e.value.includes("%")?(t=e.name.replace("攻击力","attackPercentage").replace("防御力","defendPercentage").replace("生命值","lifePercentage").replace("暴击率","critical").replace("暴击伤害","criticalDamage").replace("元素充能效率","recharge").replace("治疗加成","cureEffect").replace("物理伤害加成","physicalBonus").replace("火元素伤害加成","fireBonus").replace("雷元素伤害加成","thunderBonus").replace("冰元素伤害加成","iceBonus").replace("水元素伤害加成","waterBonus").replace("风元素伤害加成","windBonus").replace("岩元素伤害加成","rockBonus"),n=e.value.replace("%",""),o=100,r=_e(n).div(o).toNumber()):(t=e.name.replace("攻击力","attackStatic").replace("防御力","defendStatic").replace("生命值","lifeStatic").replace("元素精通","elementalMastery"),r=Number(e.value)),{name:t,value:r}}const ze=e=>{let t={flower:[],feather:[],sand:[],cup:[],head:[]},r=0;return e.forEach((e=>{let n={setName:(a=e.alternative,a.replace("冰风迷途的勇士","blizzardStrayer").replace("平息雷鸣的尊者","thunderSmoother").replace("渡过烈火的贤人","lavaWalker").replace("被怜爱的少女","maidenBeloved").replace("角斗士的终幕礼","gladiatorFinale").replace("翠绿之影","viridescentVenerer").replace("流浪大地的乐团","wandererTroupe").replace("如雷的盛怒","thunderingFury").replace("炽烈的炎之魔女","crimsonWitch").replace("昔日宗室之仪","noblesseOblige").replace("染血的骑士道","bloodstainedChivalry").replace("悠古的磐岩","archaicPetra").replace("逆飞的流星","retracingBolide").replace("沉沦之心","heartOfDepth").replace("千岩牢固","tenacityOfTheMillelith").replace("苍白之火","paleFlame").replace("追忆之注连","shimenawaReminiscence").replace("绝缘之旗印","emblemOfSeveredFate")),position:(o=e.part,o.replace("生之花","flower").replace("死之羽","feather").replace("时之沙","sand").replace("空之杯","cup").replace("理之冠","head")),mainTag:Ue(e.main),normalTags:[Ue(e.second1),Ue(e.second2),Ue(e.second3),Ue(e.second4)],omit:!1,star:5,level:20,id:r++};var o,a;t[n.position].push(n)})),t},Fe=(t=class{constructor(t){var n,o,a,s;((e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)})(this,e,void 0),a=t,r(n=this,o=e,"write to private field"),s?s.call(n,a):o.set(n,a)}toFile(){switch(n(this,e).constructor.name){case"File":return new File([n(this,e)],"");case"HTMLCanvasElement":return new File([new Uint8Array(atob(n(this,e).toDataURL().split(",")[1]).split("").map((e=>e.charCodeAt())))],"")}}toURL(){switch(n(this,e).constructor.name){case"File":return URL.createObjectURL(n(this,e));case"HTMLCanvasElement":return n(this,e).toDataURL()}}toBuffer(){switch(n(this,e).constructor.name){case"ArrayBuffer":return n(this,e).slice();case"File":return new Promise((t=>{const r=new FileReader;r.onload=()=>t(r.result),r.readAsArrayBuffer(n(this,e))}))}}toCanvas(){switch(n(this,e).constructor.name){case"File":return new Promise((t=>{const r=new Image;r.onload=()=>{const e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0),t(e)},r.src=URL.createObjectURL(n(this,e))}));case"HTMLCanvasElement":return(()=>{const t=document.createElement("canvas");return t.width=n(this,e).width,t.height=n(this,e).height,t.getContext("2d").drawImage(n(this,e),0,0),t})()}}},e=new WeakMap,t),Ge=async e=>{let t=await e.toBuffer(),r=o({MEMFS:[{name:"input.mp4",data:t}],arguments:["-i","input.mp4","output.mp3"]});return new Fe(r.MEMFS[0].data.buffer)},Ve=async(e,t)=>{const r=new(window.AudioContext||window.webkitAudioContext),n=await e.toBuffer(),o=await new Promise((e=>r.decodeAudioData(n,e)));return((e,t)=>{const r=[];for(let n=0;n<e.length/t;n++){let o=0;const a=n*t,s=Math.min(a+t,e.length);for(let t=a;t<s;t++)o=Math.max(e[t],o);r.push(o)}return r})((e=>{let t=[...e].abs();return t.div(t.max())})(o.getChannelData(0)),o.sampleRate/t)},Xe=(e,t)=>{let r=[],n=[];for(let o=0;o<e.length;o++)e[o]>=.5?n.push(o):n[0]&&(r.push(~~(n.reduce(((e,t)=>e+t))/n.length)/t),n=[]);return r},qe=(e,t)=>new Promise((r=>{let n=0;const o=[],a=document.createElement("video");a.addEventListener("loadeddata",(()=>a.currentTime=t[n])),a.addEventListener("seeked",(()=>{if(n<t.length){const e=document.createElement("canvas");e.width=a.videoWidth,e.height=a.videoHeight,requestAnimationFrame((()=>{e.getContext("2d").drawImage(a,0,0,a.videoWidth,a.videoHeight),o.push(e),a.currentTime=t[n+=1]||0}))}else r(o)})),a.playsInline=!0,a.src=e.toURL(),a.play(),a.pause()})),Ye=(e,t,r,n,o)=>{const a=document.createElement("canvas");return a.width=n,a.height=o,a.getContext("2d").drawImage(e,t,r,n,o,0,0,n,o),a};window.cv=c;const We=e=>{let t=(()=>{let t=c.imread(e),r=new c.MatVector,n=new c.Mat;c.cvtColor(t,t,c.COLOR_RGB2GRAY),c.threshold(t,t,0,255,c.THRESH_TRIANGLE),c.findContours(t,r,n,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let o=[];for(let e=0;e<r.size();e++)o.push(c.contourArea(r.get(e)));let a=c.boundingRect(r.get(o.indexOf(Math.max(...o))));return t.delete(),r.delete(),n.delete(),a})(),r=(()=>{let r=c.imread(e).roi(new c.Rect(t.x,0,t.width,t.y)),n=new c.MatVector,o=new c.Mat;c.cvtColor(r,r,c.COLOR_RGB2GRAY),c.threshold(r,r,100,255,c.THRESH_BINARY),c.findContours(r,n,o,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let a=null;for(let e=0;e<n.size();e++){let r=c.boundingRect(n.get(e));r.width==t.width&&(a=r)}return r.delete(),n.delete(),o.delete(),a})();return[t.x,r.y,t.width,t.y+t.height-r.y]},Je=e=>{let t=(()=>{let t=c.imread(e.toCanvas()),r=new c.MatVector,n=new c.Mat;c.cvtColor(t,t,c.COLOR_RGB2GRAY),c.threshold(t,t,0,255,c.THRESH_TRIANGLE),c.findContours(t,r,n,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let o=[];for(let e=0;e<r.size();e++)o.push(c.contourArea(r.get(e)));let a=c.boundingRect(r.get(o.indexOf(Math.max(...o))));return t.delete(),r.delete(),n.delete(),a})(),r=(()=>{let r=c.imread(e.toCanvas()).roi(new c.Rect(t.x,t.y,t.width,t.height)),n=c.Mat.ones(8,16,c.CV_8U),o=new c.Mat(r.rows,r.cols,c.CV_8UC3,[35,43,46,0]),a=new c.Mat(r.rows,r.cols,c.CV_8UC3,[77,255,255,0]),s=new c.MatVector,i=new c.Mat;c.erode(r,r,n),c.cvtColor(r,r,c.COLOR_RGB2HSV),c.inRange(r,o,a,r),c.findContours(r,s,i,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let l=[];for(let e=0;e<s.size();e++)l.push(c.contourArea(s.get(e)));let u=c.boundingRect(s.get(l.indexOf(Math.max(...l))));return r.delete(),n.delete(),o.delete(),a.delete(),s.delete(),i.delete(),u})(),n=(()=>{let n=c.imread(e.toCanvas()).roi(new c.Rect(t.x,t.y,t.width,r.y)),o=c.Mat.ones(8,16,c.CV_8U),a=new c.MatVector,s=new c.Mat;c.erode(n,n,o),c.cvtColor(n,n,c.COLOR_RGB2GRAY),c.threshold(n,n,0,255,c.THRESH_OTSU),c.bitwise_not(n,n),c.findContours(n,a,s,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let i=[];for(let e=0;e<a.size();e++)i.push(c.boundingRect(a.get(e)));let l=[0,t.width/2];return n.delete(),o.delete(),a.delete(),s.delete(),i.filter((e=>e.x>l[0]&&e.x<l[1])).sort(((e,t)=>e.y-t.y))})(),o=(()=>{let r=c.imread(e.toCanvas()).roi(new c.Rect(t.x,0,t.width,t.y)),n=c.Mat.ones(8,16,c.CV_8U),o=new c.MatVector,a=new c.Mat;c.dilate(r,r,n),c.cvtColor(r,r,c.COLOR_RGB2GRAY),c.threshold(r,r,0,255,c.THRESH_OTSU),c.findContours(r,o,a,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let s=[];for(let e=0;e<o.size();e++)s.push(c.boundingRect(o.get(e)));let i=[0,t.width/2];return r.delete(),n.delete(),o.delete(),a.delete(),s.filter((e=>e.x>i[0]&&e.x<i[1])).sort(((e,t)=>e.y-t.y))})();return{part:[o[1].x-3,o[1].y-3,o[1].width+3,o[1].height+3],main1:[o[2].x-3,o[2].y-3,o[2].width+3,o[2].height+3],main2:[o[3].x-3,o[3].y-3,o[3].width+3,o[3].height+3],second:n.slice(1).map((e=>[e.x-3,t.y+e.y-3,e.width+3,e.height+3])),alternative:[r.x-3,t.y+r.y-3,r.width+3,r.height+3]}};class Ke{constructor(){let e="123456789.0%+生之花死羽时沙空杯理冠防御力命值攻击岩元素伤害加成水雷风火冰物充能效率暴治疗精通迷途的勇士平息鸣尊者渡过烈贤人被怜爱少女角斗终幕礼翠绿影流浪大地乐团如盛怒炽炎魔昔日宗室仪染血骑道悠古磐逆飞星沉沦心千牢固苍白追忆注连绝缘旗印";this.encode_table=t=>t.map((t=>e.indexOf(t)+1)),this.decode_table=t=>t.map((t=>e[t-1]||""))}removeRepetition(e){let t=[];for(let r in e)e[r]!=e[r-1]&&t.push(e[r]);return t}decode(e){return e.argMax(2).arraySync().map(this.removeRepetition).map(this.decode_table).map((e=>e.join("")))}}const Qe=(e,t)=>{let r=c.imread(e);c.cvtColor(r,r,c.COLOR_RGBA2GRAY),c.blur(r,r,new c.Size(3,3));let n=Math.min(...r.data);r.data.map(((e,t)=>r.data[t]=r.data[t]-n));let o=Math.max(...r.data);r.data.map(((e,t)=>r.data[t]=r.data[t]/o*255)),r.data[r.data.length-1]>=127.5&&r.data.map(((e,t)=>r.data[t]=255-r.data[t]));let s=new c.Mat;c.threshold(r,s,0,255,c.THRESH_OTSU),s=a(s.data,[s.rows,s.cols],"bool");let[i,l]=[s.any(0),s.any(1)],u=i.argMax().arraySync();if(t){let e=i.arraySync().slice(u).indexOf(0);u=u+e+i.arraySync().slice(u+e).indexOf(1)}let f=l.argMax().arraySync(),d=r.cols-i.reverse().argMax().arraySync()-u,h=r.rows-l.reverse().argMax().arraySync()-f;return r=r.roi(new c.Rect(u,f,d,h)),c.resize(r,r,new c.Size(16/r.rows*r.cols,16),0,0,c.INTER_LINEAR),c.copyMakeBorder(r,r,0,0,0,192-r.cols,c.BORDER_CONSTANT),[...r.data].map((e=>e/255))};let Ze=null,et=null;const tt=async e=>{const t=e=>({name:(e.split("+")[0]||"").replace(/[^攻击力生命值防御元素充能效率暴伤害精通]/g,""),value:(e.split("+")[1]||"").replace(/[^123456789.0%]/g,"")}),r=Je(e);let n=Qe(Ye(e.toCanvas(),...r.part)),o=Qe(Ye(e.toCanvas(),...r.main1)),a=Qe(Ye(e.toCanvas(),...r.main2)),c=Qe(Ye(e.toCanvas(),...r.second[0]),!0),l=Qe(Ye(e.toCanvas(),...r.second[1]),!0),u=Qe(Ye(e.toCanvas(),...r.second[2]),!0),f=Qe(Ye(e.toCanvas(),...r.second[3]),!0),d=Qe(Ye(e.toCanvas(),...r.alternative)),h=await(async e=>{Ze||(Ze=new Ke),et||(et=await s("langPath/model.json"));let t=et.predict(i(e.flat(),[e.length,16,192,1]));return Ze.decode(t)})([n,o,a,c,l,u,f,d]);[n,o,a,c,l,u,f,d]=h;return{part:n.replace(/[^生之花死羽时沙空杯理冠]/g,""),main:{name:o.replace(/[^防御力生命值攻击岩元素伤害加成水雷风火冰物理充能效率暴治疗精通]/g,""),value:a.replace(/[^123456789.0%]/g,"")},second1:t(c),second2:t(l),second3:t(u),second4:t(f),alternative:d.replace(/[^冰风迷途的勇士平息鸣雷尊者渡过烈火贤人被怜爱少女角斗终幕礼翠绿之影流浪大地乐团如盛怒炽炎魔昔日宗室仪染血骑道悠古磐岩逆飞星沉沦心千牢固苍白追忆注连绝缘旗印]/g,"")}},rt=(e,t)=>_e(e).plus(t).toNumber(),nt=(e,t)=>_e(e).times(t).toNumber();let ot={flower:{"生命值":4780},feather:{"攻击力":311},sand:{"攻击力%":.466},cup:{"攻击力%":.466,"岩元素伤害加成":.466,"水元素伤害加成":.466,"雷元素伤害加成":.466,"风元素伤害加成":.466,"火元素伤害加成":.466,"冰元素伤害加成":.466,"物理伤害加成":.583},head:{"攻击力%":.466,"暴击率":.311,"暴击伤害":.622},second:{"攻击力%":.058,"暴击率":.039,"暴击伤害":.078,"攻击力":19}},at=(e,t,r,n,o,a,s,i)=>((...e)=>e.reduce(((e,t)=>e.times(t)),_e(1)).toNumber())(rt(nt(rt(e,t),rt(1,r)),n),o,rt(1,a),rt(1,nt(Math.min(s,1),i))),st=e=>{var t={};for(var r of Object.values(e))for(var[n,o]of Object.entries(r))t[n]=(t[n]||0)+o;return t},it=((...e)=>e.reduce(((e,t)=>{const r=[];return e.forEach((e=>t.forEach((t=>r.push([...e,t]))))),r}),[[]]))(Object.entries(ot.flower),Object.entries(ot.feather),Object.entries(ot.sand),Object.entries(ot.cup),Object.entries(ot.head));function ct(e,t){var r={flower:{},feather:{},sand:{},cup:{},head:{}};t=t.replace("phys","物理伤害加成").replace("雷","雷元素伤害加成").replace("岩","岩元素伤害加成").replace("风","风元素伤害加成").replace("水","水元素伤害加成").replace("火","火元素伤害加成");for(var n=0;n<45;n++)Object.keys(ot.second).map((function(n){var o=JSON.parse(JSON.stringify(r));for(var a in o){const e=o[a],t=Object.values(e);if((4==t.length?e[n]:!e[n])&&(e[n]||0)<6&&t.reduce(((e,t)=>e+t),0)<9){e[n]=(e[n]||0)+1;break}}var s=st(o);return[at(e["角色攻击力"]||0,e["武器攻击力"]||0,rt(nt(ot.second["攻击力%"],s["攻击力%"]||0),e["攻击力%"]||0),rt(nt(ot.second["攻击力"],s["攻击力"]||0),e["攻击力"]||0),e["技能倍率"]||0,e[t]||0,rt(nt(ot.second["暴击率"],s["暴击率"]||0),e["暴击率"]||0),rt(nt(ot.second["暴击伤害"],s["暴击伤害"]||0),e["暴击伤害"]||0)),()=>r=o]})).sort(((e,t)=>t[0]-e[0]))[0][1]();for(var[o,a]of Object.entries(st(r)))e[o]=rt(e[o]||0,nt(ot.second[o],a));return[at(e["角色攻击力"]||0,e["武器攻击力"]||0,e["攻击力%"]||0,e["攻击力"]||0,e["技能倍率"]||0,e[t]||0,e["暴击率"]||0,e["暴击伤害"]||0),e]}const lt=(e,t,r,n,o)=>{let a=[];for(let c of it){let l={"角色攻击力":t,"武器攻击力":r,"技能倍率":n};for(var[s,i]of o)l[s]=rt(l[s]||0,i);for(var[s,i]of c)l[s]=rt(l[s]||0,i);a.push(ct(l,e))}return[...a].sort(((e,t)=>t[0]-e[0]))[0]};export{We as $,he as A,m as B,B as C,le as D,ue as E,pe as F,Ie as G,q as H,W as I,R as J,Ye as K,U as L,Fe as M,Je as N,ie as O,ce as P,G as Q,ke as R,we as S,De as T,E as U,Pe as V,tt as W,Ge as X,Ve as Y,Xe as Z,qe as _,f as a,lt as a0,T as b,k as c,D as d,N as e,O as f,fe as g,S as h,ge as i,y as j,P as k,j as l,v as m,l as n,$ as o,z as p,H as q,F as r,g as s,L as t,I as u,p as v,b as w,Be as x,ze as y,de as z};
