"undefined"!=typeof require&&require;var e,t,r=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},n=(e,t,n)=>(r(e,t,"read from private field"),n?n.call(e):t.get(e));import{f as o}from"./ffmpeg.f969c7f1.js";import{t as a,l as s,a as i}from"./vendor.eb3e7ad3.js";import{c}from"./opencv.be337fbb.js";function u(){}const l=e=>e;function f(e,t){for(const r in t)e[r]=t[r];return e}function d(e){return e()}function h(){return Object.create(null)}function p(e){e.forEach(d)}function m(e){return"function"==typeof e}function g(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let v;function w(e,t){return v||(v=document.createElement("a")),v.href=t,e===v.href}function b(e,t,r){e.$$.on_destroy.push(function(e,...t){if(null==e)return u;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}(t,r))}function y(e){const t={};for(const r in e)"$"!==r[0]&&(t[r]=e[r]);return t}function E(e){return null==e?"":e}function $(e,t,r){return e.set(r),t}const R="undefined"!=typeof window;let O=R?()=>window.performance.now():()=>Date.now(),x=R?e=>requestAnimationFrame(e):u;const M=new Set;function C(e){M.forEach((t=>{t.c(e)||(M.delete(t),t.f())})),0!==M.size&&x(C)}function A(e,t){e.appendChild(t)}function N(e,t,r){e.insertBefore(t,r||null)}function _(e){e.parentNode.removeChild(e)}function S(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function j(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function T(e){return document.createTextNode(e)}function k(){return T(" ")}function L(){return T("")}function D(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function B(e){return function(t){return t.preventDefault(),e.call(this,t)}}function F(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function I(e,t){for(const r in t)F(e,r,t[r])}function z(e){return""===e?null:+e}function U(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function H(e,t){e.value=null==t?"":t}function q(e,t,r){e.classList[r?"add":"remove"](t)}let G;function W(e){G=e}function V(e,t){const r=e.$$.callbacks[t.type];r&&r.slice().forEach((e=>e.call(this,t)))}const X=[],J=[],Y=[],K=[],Q=Promise.resolve();let Z=!1;function ee(e){Y.push(e)}let te=!1;const re=new Set;function ne(){if(!te){te=!0;do{for(let e=0;e<X.length;e+=1){const t=X[e];W(t),oe(t.$$)}for(W(null),X.length=0;J.length;)J.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];re.has(t)||(re.add(t),t())}Y.length=0}while(X.length);for(;K.length;)K.pop()();Z=!1,te=!1,re.clear()}}function oe(e){if(null!==e.fragment){e.update(),p(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ee)}}const ae=new Set;let se;function ie(){se={r:0,c:[],p:se}}function ce(){se.r||p(se.c),se=se.p}function ue(e,t){e&&e.i&&(ae.delete(e),e.i(t))}function le(e,t,r,n){if(e&&e.o){if(ae.has(e))return;ae.add(e),se.c.push((()=>{ae.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}}function fe(e,t){const r={},n={},o={$$scope:1};let a=e.length;for(;a--;){const s=e[a],i=t[a];if(i){for(const e in s)e in i||(n[e]=1);for(const e in i)o[e]||(r[e]=i[e],o[e]=1);e[a]=i}else for(const e in s)o[e]=1}for(const s in n)s in r||(r[s]=void 0);return r}function de(e){e&&e.c()}function he(e,t,r,n){const{fragment:o,on_mount:a,on_destroy:s,after_update:i}=e.$$;o&&o.m(t,r),n||ee((()=>{const t=a.map(d).filter(m);s?s.push(...t):p(t),e.$$.on_mount=[]})),i.forEach(ee)}function pe(e,t){const r=e.$$;null!==r.fragment&&(p(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function me(e,t){-1===e.$$.dirty[0]&&(X.push(e),Z||(Z=!0,Q.then(ne)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(e,t,r,n,o,a,s,i=[-1]){const c=G;W(e);const l=e.$$={fragment:null,ctx:null,props:a,update:u,not_equal:o,bound:h(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:t.context||[]),callbacks:h(),dirty:i,skip_bound:!1,root:t.target||c.$$.root};s&&s(l.root);let f=!1;if(l.ctx=r?r(e,t.props||{},((t,r,...n)=>{const a=n.length?n[0]:r;return l.ctx&&o(l.ctx[t],l.ctx[t]=a)&&(!l.skip_bound&&l.bound[t]&&l.bound[t](a),f&&me(e,t)),r})):[],l.update(),f=!0,p(l.before_update),l.fragment=!!n&&n(l.ctx),t.target){if(t.hydrate){const e=(d=t.target,Array.from(d.childNodes));l.fragment&&l.fragment.l(e),e.forEach(_)}else l.fragment&&l.fragment.c();t.intro&&ue(e.$$.fragment),he(e,t.target,t.anchor,t.customElement),ne()}var d;W(c)}class ve{$destroy(){pe(this,1),this.$destroy=u}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var we="[big.js] ",be=we+"Invalid ",ye=be+"decimal places",Ee={},$e=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Re(e,t,r,n){var o=e.c;if(undefined===r&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error("[big.js] Invalid rounding mode");if(t<1)n=3===r&&(n||!!o[0])||0===t&&(1===r&&o[0]>=5||2===r&&(o[0]>5||5===o[0]&&(n||undefined!==o[1]))),o.length=1,n?(e.e=e.e-t+1,o[0]=1):o[0]=e.e=0;else if(t<o.length){if(n=1===r&&o[t]>=5||2===r&&(o[t]>5||5===o[t]&&(n||undefined!==o[t+1]||1&o[t-1]))||3===r&&(n||!!o[0]),o.length=t--,n)for(;++o[t]>9;)o[t]=0,t--||(++e.e,o.unshift(1));for(t=o.length;!o[--t];)o.pop()}return e}function Oe(e,t,r){var n=e.e,o=e.c.join(""),a=o.length;if(t)o=o.charAt(0)+(a>1?"."+o.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)o="0"+o;o="0."+o}else if(n>0)if(++n>a)for(n-=a;n--;)o+="0";else n<a&&(o=o.slice(0,n)+"."+o.slice(n));else a>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&r?"-"+o:o}Ee.abs=function(){var e=new this.constructor(this);return e.s=1,e},Ee.cmp=function(e){var t,r=this,n=r.c,o=(e=new r.constructor(e)).c,a=r.s,s=e.s,i=r.e,c=e.e;if(!n[0]||!o[0])return n[0]?a:o[0]?-s:0;if(a!=s)return a;if(t=a<0,i!=c)return i>c^t?1:-1;for(s=(i=n.length)<(c=o.length)?i:c,a=-1;++a<s;)if(n[a]!=o[a])return n[a]>o[a]^t?1:-1;return i==c?0:i>c^t?1:-1},Ee.div=function(e){var t=this,r=t.constructor,n=t.c,o=(e=new r(e)).c,a=t.s==e.s?1:-1,s=r.DP;if(s!==~~s||s<0||s>1e6)throw Error(ye);if(!o[0])throw Error("[big.js] Division by zero");if(!n[0])return e.s=a,e.c=[e.e=0],e;var i,c,u,l,f,d=o.slice(),h=i=o.length,p=n.length,m=n.slice(0,i),g=m.length,v=e,w=v.c=[],b=0,y=s+(v.e=t.e-e.e)+1;for(v.s=a,a=y<0?0:y,d.unshift(0);g++<i;)m.push(0);do{for(u=0;u<10;u++){if(i!=(g=m.length))l=i>g?1:-1;else for(f=-1,l=0;++f<i;)if(o[f]!=m[f]){l=o[f]>m[f]?1:-1;break}if(!(l<0))break;for(c=g==i?o:d;g;){if(m[--g]<c[g]){for(f=g;f&&!m[--f];)m[f]=9;--m[f],m[g]+=10}m[g]-=c[g]}for(;!m[0];)m.shift()}w[b++]=l?u:++u,m[0]&&l?m[g]=n[h]||0:m=[n[h]]}while((h++<p||undefined!==m[0])&&a--);return w[0]||1==b||(w.shift(),v.e--,y--),b>y&&Re(v,y,r.RM,undefined!==m[0]),v},Ee.eq=function(e){return 0===this.cmp(e)},Ee.gt=function(e){return this.cmp(e)>0},Ee.gte=function(e){return this.cmp(e)>-1},Ee.lt=function(e){return this.cmp(e)<0},Ee.lte=function(e){return this.cmp(e)<1},Ee.minus=Ee.sub=function(e){var t,r,n,o,a=this,s=a.constructor,i=a.s,c=(e=new s(e)).s;if(i!=c)return e.s=-c,a.plus(e);var u=a.c.slice(),l=a.e,f=e.c,d=e.e;if(!u[0]||!f[0])return f[0]?e.s=-c:u[0]?e=new s(a):e.s=1,e;if(i=l-d){for((o=i<0)?(i=-i,n=u):(d=l,n=f),n.reverse(),c=i;c--;)n.push(0);n.reverse()}else for(r=((o=u.length<f.length)?u:f).length,i=c=0;c<r;c++)if(u[c]!=f[c]){o=u[c]<f[c];break}if(o&&(n=u,u=f,f=n,e.s=-e.s),(c=(r=f.length)-(t=u.length))>0)for(;c--;)u[t++]=0;for(c=t;r>i;){if(u[--r]<f[r]){for(t=r;t&&!u[--t];)u[t]=9;--u[t],u[r]+=10}u[r]-=f[r]}for(;0===u[--c];)u.pop();for(;0===u[0];)u.shift(),--d;return u[0]||(e.s=1,u=[d=0]),e.c=u,e.e=d,e},Ee.mod=function(e){var t,r=this,n=r.constructor,o=r.s,a=(e=new n(e)).s;if(!e.c[0])throw Error("[big.js] Division by zero");return r.s=e.s=1,t=1==e.cmp(r),r.s=o,e.s=a,t?new n(r):(o=n.DP,a=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=o,n.RM=a,this.minus(r.times(e)))},Ee.plus=Ee.add=function(e){var t,r,n,o=this,a=o.constructor;if(e=new a(e),o.s!=e.s)return e.s=-e.s,o.minus(e);var s=o.e,i=o.c,c=e.e,u=e.c;if(!i[0]||!u[0])return u[0]||(i[0]?e=new a(o):e.s=o.s),e;if(i=i.slice(),t=s-c){for(t>0?(c=s,n=u):(t=-t,n=i),n.reverse();t--;)n.push(0);n.reverse()}for(i.length-u.length<0&&(n=u,u=i,i=n),t=u.length,r=0;t;i[t]%=10)r=(i[--t]=i[t]+u[t]+r)/10|0;for(r&&(i.unshift(r),++c),t=i.length;0===i[--t];)i.pop();return e.c=i,e.e=c,e},Ee.pow=function(e){var t=this,r=new t.constructor("1"),n=r,o=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(be+"exponent");for(o&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return o?r.div(n):n},Ee.prec=function(e,t){if(e!==~~e||e<1||e>1e6)throw Error(be+"precision");return Re(new this.constructor(this),e,t)},Ee.round=function(e,t){if(undefined===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(ye);return Re(new this.constructor(this),e+this.e+1,t)},Ee.sqrt=function(){var e,t,r,n=this,o=n.constructor,a=n.s,s=n.e,i=new o("0.5");if(!n.c[0])return new o(n);if(a<0)throw Error(we+"No square root");0===(a=Math.sqrt(n+""))||a===1/0?((t=n.c.join("")).length+s&1||(t+="0"),s=((s+1)/2|0)-(s<0||1&s),e=new o(((a=Math.sqrt(t))==1/0?"5e":(a=a.toExponential()).slice(0,a.indexOf("e")+1))+s)):e=new o(a+""),s=e.e+(o.DP+=4);do{r=e,e=i.times(r.plus(n.div(r)))}while(r.c.slice(0,s).join("")!==e.c.slice(0,s).join(""));return Re(e,(o.DP-=4)+e.e+1,o.RM)},Ee.times=Ee.mul=function(e){var t,r=this,n=r.constructor,o=r.c,a=(e=new n(e)).c,s=o.length,i=a.length,c=r.e,u=e.e;if(e.s=r.s==e.s?1:-1,!o[0]||!a[0])return e.c=[e.e=0],e;for(e.e=c+u,s<i&&(t=o,o=a,a=t,u=s,s=i,i=u),t=new Array(u=s+i);u--;)t[u]=0;for(c=i;c--;){for(i=0,u=s+c;u>c;)i=t[u]+a[c]*o[u-c-1]+i,t[u--]=i%10,i=i/10|0;t[u]=i}for(i?++e.e:t.shift(),c=t.length;!t[--c];)t.pop();return e.c=t,e},Ee.toExponential=function(e,t){var r=this,n=r.c[0];if(undefined!==e){if(e!==~~e||e<0||e>1e6)throw Error(ye);for(r=Re(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return Oe(r,!0,!!n)},Ee.toFixed=function(e,t){var r=this,n=r.c[0];if(undefined!==e){if(e!==~~e||e<0||e>1e6)throw Error(ye);for(e=e+(r=Re(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return Oe(r,!1,!!n)},Ee.toJSON=Ee.toString=function(){var e=this,t=e.constructor;return Oe(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},Ee.toNumber=function(){var e=Number(Oe(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(we+"Imprecise conversion");return e},Ee.toPrecision=function(e,t){var r=this,n=r.constructor,o=r.c[0];if(undefined!==e){if(e!==~~e||e<1||e>1e6)throw Error(be+"precision");for(r=Re(new n(r),e,t);r.c.length<e;)r.c.push(0)}return Oe(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!o)},Ee.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(we+"valueOf disallowed");return Oe(e,e.e<=t.NE||e.e>=t.PE,!0)};var xe=function e(){function t(r){var n=this;if(!(n instanceof t))return undefined===r?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict)throw TypeError(be+"number");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,n,o;if(!$e.test(t))throw Error(be+"number");e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".",""));(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length);for(o=t.length,n=0;n<o&&"0"==t.charAt(n);)++n;if(n==o)e.c=[e.e=0];else{for(;o>0&&"0"==t.charAt(--o););for(e.e=r-n-1,e.c=[],r=0;n<=o;)e.c[r++]=+t.charAt(n++)}}(n,r)}n.constructor=t}return t.prototype=Ee,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=false,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();const Me=(...e)=>e.reduce(((e,t)=>e.plus(t)),xe(0)).toNumber(),Ce=(e,t)=>xe(e).plus(t).toNumber(),Ae=(e,t)=>xe(e).minus(t).toNumber(),Ne=[[4.1,4.7,5.3,5.8],[4.1,4.7,5.3,5.8],[5.1,5.8,6.6,7.3],[4.5,5.2,5.8,6.5],[2.7,3.1,3.5,3.9],[5.4,6.2,7,7.8],[14,16,18,19],[209,239,269,299],[16,19,21,23],[16,19,21,23]];const _e=e=>{var t;e.value.includes("%")?t={"防御力":58.3,"生命值":46.6,"攻击力":46.6,"岩元素伤害加成":46.6,"水元素伤害加成":46.6,"雷元素伤害加成":46.6,"风元素伤害加成":46.6,"火元素伤害加成":46.6,"冰元素伤害加成":46.6,"物理伤害加成":58.3,"元素充能效率":51.8,"暴击率":31.1,"暴击伤害":62.2,"治疗加成":35.9}[e.name]:t={"生命值":4780,"攻击力":311,"元素精通":187}[e.name];return t==e.value.replace("%","")},Se=e=>{const t=e=>4==Ne[e].length?Ne[e]=function(e){let t=[];for(let r of e)for(let n of e)for(let o of e)for(let a of e)for(let s of e)for(let i of e)t.push(Me(r)),t.push(Me(r,n)),t.push(Me(r,n,o)),t.push(Me(r,n,o,a)),t.push(Me(r,n,o,a,s)),t.push(Me(r,n,o,a,s,i));return t}(Ne[e]):Ne[e],r=(e,t)=>e.includes(t);if(e.value.includes("%")){if(null==(a={"攻击力":0,"生命值":1,"防御力":2,"元素充能效率":3,"暴击率":4,"暴击伤害":5})[e.name])return!1;var n=t(a[e.name]),o=Number(e.value.replace("%",""));return!isNaN(o)&&(r(n,o)||r(n,Ce(o,.1))||r(n,Ae(o,.1)))}var a;if(null==(a={"攻击力":6,"生命值":7,"防御力":8,"元素精通":9})[e.name])return!1;n=t(a[e.name]),o=Number(e.value.replace("%",""));return!isNaN(o)&&(r(n,o)||r(n,Ce(o,1))||r(n,Ae(o,1)))},je=e=>{return[(r=e.part,["生之花","死之羽","时之沙","空之杯","理之冠"].includes(r)),_e(e.main),Se(e.second1),Se(e.second2),Se(e.second3),Se(e.second4),(t=e.alternative,["冰风迷途的勇士","平息鸣雷的尊者","渡过烈火的贤人","被怜爱的少女","角斗士的终幕礼","翠绿之影","流浪大地的乐团","如雷的盛怒","炽烈的炎之魔女","昔日宗室之仪","染血的骑士道","悠古的磐岩","逆飞的流星","沉沦之心","千岩牢固","苍白之火","追忆之注连","绝缘之旗印"].includes(t))];var t,r},Pe=[];function Te(e,t=u){let r;const n=new Set;function o(t){if(g(e,t)&&(e=t,r)){const t=!Pe.length;for(const r of n)r[1](),Pe.push(r,e);if(t){for(let e=0;e<Pe.length;e+=2)Pe[e][0](Pe[e+1]);Pe.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(a,s=u){const i=[a,s];return n.add(i),1===n.size&&(r=t(o)||u),a(e),()=>{n.delete(i),0===n.size&&(r(),r=null)}}}}function ke(e){return"[object Date]"===Object.prototype.toString.call(e)}function Le(e,t){if(e===t||e!=e)return()=>e;const r=typeof e;if(r!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const r=t.map(((t,r)=>Le(e[r],t)));return e=>r.map((t=>t(e)))}if("object"===r){if(!e||!t)throw new Error("Object cannot be null");if(ke(e)&&ke(t)){e=e.getTime();const r=(t=t.getTime())-e;return t=>new Date(e+t*r)}const r=Object.keys(t),n={};return r.forEach((r=>{n[r]=Le(e[r],t[r])})),e=>{const t={};return r.forEach((r=>{t[r]=n[r](e)})),t}}if("number"===r){const r=t-e;return t=>e+t*r}throw new Error(`Cannot interpolate ${r} values`)}const De={video:Te(),images:Te(),setting:{x:Te(),y:Te(),width:Te(),height:Te()}},Be=Te(),Fe=Te(),Ie=function(e,t={}){const r=Te(e);let n,o=e;function a(a,s){if(null==e)return r.set(e=a),Promise.resolve();o=a;let i=n,c=!1,{delay:u=0,duration:d=400,easing:h=l,interpolate:p=Le}=f(f({},t),s);if(0===d)return i&&(i.abort(),i=null),r.set(e=o),Promise.resolve();const m=O()+u;let g;return n=function(e){let t;return 0===M.size&&x(C),{promise:new Promise((r=>{M.add(t={c:e,f:r})})),abort(){M.delete(t)}}}((t=>{if(t<m)return!0;c||(g=p(e,a),"function"==typeof d&&(d=d(e,a)),c=!0),i&&(i.abort(),i=null);const n=t-m;return n>d?(r.set(e=a),!1):(r.set(e=g(h(n/d))),!0)})),n.promise}return{set:a,update:(t,r)=>a(t(o,e),r),subscribe:r.subscribe}}(0,{duration:1e3,easing:function(e){const t=e-1;return t*t*t+1}});function ze(e){let t,r;var n,o;return e.value.includes("%")?(t=e.name.replace("攻击力","attackPercentage").replace("防御力","defendPercentage").replace("生命值","lifePercentage").replace("暴击率","critical").replace("暴击伤害","criticalDamage").replace("元素充能效率","recharge").replace("治疗加成","cureEffect").replace("物理伤害加成","physicalBonus").replace("火元素伤害加成","fireBonus").replace("雷元素伤害加成","thunderBonus").replace("冰元素伤害加成","iceBonus").replace("水元素伤害加成","waterBonus").replace("风元素伤害加成","windBonus").replace("岩元素伤害加成","rockBonus"),n=e.value.replace("%",""),o=100,r=xe(n).div(o).toNumber()):(t=e.name.replace("攻击力","attackStatic").replace("防御力","defendStatic").replace("生命值","lifeStatic").replace("元素精通","elementalMastery"),r=Number(e.value)),{name:t,value:r}}const Ue=e=>{let t={flower:[],feather:[],sand:[],cup:[],head:[]},r=0;return e.forEach((e=>{let n={setName:(a=e.alternative,a.replace("冰风迷途的勇士","blizzardStrayer").replace("平息雷鸣的尊者","thunderSmoother").replace("渡过烈火的贤人","lavaWalker").replace("被怜爱的少女","maidenBeloved").replace("角斗士的终幕礼","gladiatorFinale").replace("翠绿之影","viridescentVenerer").replace("流浪大地的乐团","wandererTroupe").replace("如雷的盛怒","thunderingFury").replace("炽烈的炎之魔女","crimsonWitch").replace("昔日宗室之仪","noblesseOblige").replace("染血的骑士道","bloodstainedChivalry").replace("悠古的磐岩","archaicPetra").replace("逆飞的流星","retracingBolide").replace("沉沦之心","heartOfDepth").replace("千岩牢固","tenacityOfTheMillelith").replace("苍白之火","paleFlame").replace("追忆之注连","shimenawaReminiscence").replace("绝缘之旗印","emblemOfSeveredFate")),position:(o=e.part,o.replace("生之花","flower").replace("死之羽","feather").replace("时之沙","sand").replace("空之杯","cup").replace("理之冠","head")),mainTag:ze(e.main),normalTags:[ze(e.second1),ze(e.second2),ze(e.second3),ze(e.second4)],omit:!1,star:5,level:20,id:r++};var o,a;t[n.position].push(n)})),t},He=(t=class{constructor(t){var n,o,a,s;((e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)})(this,e,void 0),a=t,r(n=this,o=e,"write to private field"),s?s.call(n,a):o.set(n,a)}toFile(){switch(n(this,e).constructor.name){case"File":return new File([n(this,e)],"");case"HTMLCanvasElement":return new File([new Uint8Array(atob(n(this,e).toDataURL().split(",")[1]).split("").map((e=>e.charCodeAt())))],"")}}toURL(){switch(n(this,e).constructor.name){case"File":return URL.createObjectURL(n(this,e));case"HTMLCanvasElement":return n(this,e).toDataURL()}}toBuffer(){switch(n(this,e).constructor.name){case"ArrayBuffer":return n(this,e).slice();case"File":return new Promise((t=>{const r=new FileReader;r.onload=()=>t(r.result),r.readAsArrayBuffer(n(this,e))}))}}toCanvas(){switch(n(this,e).constructor.name){case"File":return new Promise((t=>{const r=new Image;r.onload=()=>{const e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0),t(e)},r.src=URL.createObjectURL(n(this,e))}));case"HTMLCanvasElement":return(()=>{const t=document.createElement("canvas");return t.width=n(this,e).width,t.height=n(this,e).height,t.getContext("2d").drawImage(n(this,e),0,0),t})()}}},e=new WeakMap,t),qe=async e=>{let t=await e.toBuffer(),r=o({MEMFS:[{name:"input.mp4",data:t}],arguments:["-i","input.mp4","output.mp3"]});return new He(r.MEMFS[0].data.buffer)},Ge=async(e,t)=>{const r=new(window.AudioContext||window.webkitAudioContext),n=await e.toBuffer(),o=await new Promise((e=>r.decodeAudioData(n,e)));return((e,t)=>{const r=[];for(let n=0;n<e.length/t;n++){let o=0;const a=n*t,s=Math.min(a+t,e.length);for(let t=a;t<s;t++)o=Math.max(e[t],o);r.push(o)}return r})((e=>{let t=0;for(let r in e)e[r]=Math.abs(e[r]),t=Math.max(e[r],t);for(let r in e)e[r]/=t;return e})(o.getChannelData(0)),o.sampleRate/t)},We=(e,t)=>{let r=[],n=[];for(let o=0;o<e.length;o++)e[o]>=.5?n.push(o):n[0]&&(r.push(~~(n.reduce(((e,t)=>e+t))/n.length)/t),n=[]);return r},Ve=(e,t)=>new Promise((r=>{let n=0;const o=[],a=document.createElement("video");a.addEventListener("loadeddata",(()=>a.currentTime=t[n])),a.addEventListener("seeked",(async()=>{if(n<t.length){const e=document.createElement("canvas");e.width=a.videoWidth,e.height=a.videoHeight,await new Promise((e=>setTimeout(e,512))),e.getContext("2d").drawImage(a,0,0,a.videoWidth,a.videoHeight),o.push(e),a.currentTime=t[n+=1]||0}else r(o)})),a.playsInline=!0,a.src=e.toURL(),a.play(),a.pause()})),Xe=(e,t,r,n,o)=>{const a=document.createElement("canvas");return a.width=n,a.height=o,a.getContext("2d").drawImage(e,t,r,n,o,0,0,n,o),a},Je=e=>{const t=c.imread(e);c.cvtColor(t,t,c.COLOR_RGB2GRAY),c.Canny(t,t,8,128,3,!0),c.dilate(t,t,new c.Mat);const r=new c.MatVector;c.findContours(t,r,new c.Mat,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);const n=[];for(let u=0;u<r.size();u++)n.push(c.contourArea(r.get(u)));const{x:o,y:a,width:s,height:i}=c.boundingRect(r.get(n.indexOf(Math.max(...n))));return[o+5,a+5,s-5,i-5]},Ye=e=>{const t=c.imread(e.toCanvas());c.cvtColor(t,t,c.COLOR_RGB2GRAY),c.Canny(t,t,8,128,3,!0),c.dilate(t,t,c.Mat.ones(8,32,c.CV_8U));const r=new c.MatVector;c.findContours(t,r,new c.Mat,c.RETR_EXTERNAL,c.CHAIN_APPROX_SIMPLE);let n=[];for(let o=0;o<r.size();o++){const e=r.get(o),t=c.boundingRect(e),a=t.width/t.height;a>1.5&&a<16&&n.push([t.x,t.y,t.width,t.height])}return n.reverse().slice(0,11)};class Ke{constructor(){let e="123456789.0%+生之花死羽时沙空杯理冠防御力命值攻击岩元素伤害加成水雷风火冰物充能效率暴治疗精通迷途的勇士平息鸣尊者渡过烈贤人被怜爱少女角斗终幕礼翠绿影流浪大地乐团如盛怒炽炎魔昔日宗室仪染血骑道悠古磐逆飞星沉沦心千牢固苍白追忆注连绝缘旗印";this.encode_table=t=>t.map((t=>e.indexOf(t)+1)),this.decode_table=t=>t.map((t=>e[t-1]||""))}removeRepetition(e){let t=[];for(let r in e)e[r]!=e[r-1]&&t.push(e[r]);return t}decode(e){return e.argMax(2).arraySync().map(this.removeRepetition).map(this.decode_table).map((e=>e.join("")))}}const Qe=(e,t)=>{let r=c.imread(e);c.cvtColor(r,r,c.COLOR_RGBA2GRAY),c.blur(r,r,new c.Size(3,3));let n=Math.min(...r.data);r.data.map(((e,t)=>r.data[t]=r.data[t]-n));let o=Math.max(...r.data);r.data.map(((e,t)=>r.data[t]=r.data[t]/o*255)),r.data[r.data.length-1]>=127.5&&r.data.map(((e,t)=>r.data[t]=255-r.data[t]));let s=new c.Mat;c.threshold(r,s,0,255,c.THRESH_OTSU),s=a(s.data,[s.rows,s.cols],"bool");let[i,u]=[s.any(0),s.any(1)],l=i.argMax().arraySync();if(t){let e=i.arraySync().slice(l).indexOf(0);l=l+e+i.arraySync().slice(l+e).indexOf(1)}let f=u.argMax().arraySync(),d=r.cols-i.reverse().argMax().arraySync()-l,h=r.rows-u.reverse().argMax().arraySync()-f;return r=r.roi(new c.Rect(l,f,d,h)),c.resize(r,r,new c.Size(32/r.rows*r.cols,32),0,0,c.INTER_LINEAR),c.copyMakeBorder(r,r,0,0,0,384-r.cols,c.BORDER_CONSTANT),[...r.data].map((e=>e/255))},Ze=async e=>{const t=e=>({name:(e.split("+")[0]||"").replace(/[^攻击力生命值防御元素充能效率暴伤害精通]/g,""),value:(e.split("+")[1]||"").replace(/[^123456789.0%]/g,"")}),r=Ye(e);let n=Qe(Xe(e.toCanvas(),...r[1])),o=Qe(Xe(e.toCanvas(),...r[2])),a=Qe(Xe(e.toCanvas(),...r[3])),c=Qe(Xe(e.toCanvas(),...r[6]),!0),u=Qe(Xe(e.toCanvas(),...r[7]),!0),l=Qe(Xe(e.toCanvas(),...r[8]),!0),f=Qe(Xe(e.toCanvas(),...r[9]),!0),d=Qe(Xe(e.toCanvas(),...r[10])),h=await(async e=>{let t=new Ke,r=(await s("langPath/model.json")).predict(i(e.flat(),[e.length,32,384,1]));return t.decode(r)})([n,o,a,c,u,l,f,d]);[n,o,a,c,u,l,f,d]=h;return{part:n.replace(/[^生之花死羽时沙空杯理冠]/g,""),main:{name:o.replace(/[^防御力生命值攻击岩元素伤害加成水雷风火冰物理充能效率暴治疗精通]/g,""),value:a.replace(/[^123456789.0%]/g,"")},second1:t(c),second2:t(u),second3:t(l),second4:t(f),alternative:d.replace(/[^冰风迷途的勇士平息鸣雷尊者渡过烈火贤人被怜爱少女角斗终幕礼翠绿之影流浪大地乐团如盛怒炽炎魔昔日宗室仪染血骑道悠古磐岩逆飞星沉沦心千牢固苍白追忆注连绝缘旗印]/g,"")}},et=(e,t)=>xe(e).plus(t).toNumber(),tt=(e,t)=>xe(e).times(t).toNumber();let rt={flower:{"生命值":4780},feather:{"攻击力":311},sand:{"攻击力%":.466},cup:{"攻击力%":.466,"岩元素伤害加成":.466,"水元素伤害加成":.466,"雷元素伤害加成":.466,"风元素伤害加成":.466,"火元素伤害加成":.466,"冰元素伤害加成":.466,"物理伤害加成":.583},head:{"攻击力%":.466,"暴击率":.311,"暴击伤害":.622},second:{"攻击力%":.058,"暴击率":.039,"暴击伤害":.078,"攻击力":19}},nt=(e,t,r,n,o,a,s,i)=>((...e)=>e.reduce(((e,t)=>e.times(t)),xe(1)).toNumber())(et(tt(et(e,t),et(1,r)),n),o,et(1,a),et(1,tt(Math.min(s,1),i))),ot=e=>{var t={};for(var r of Object.values(e))for(var[n,o]of Object.entries(r))t[n]=(t[n]||0)+o;return t},at=((...e)=>e.reduce(((e,t)=>{const r=[];return e.forEach((e=>t.forEach((t=>r.push([...e,t]))))),r}),[[]]))(Object.entries(rt.flower),Object.entries(rt.feather),Object.entries(rt.sand),Object.entries(rt.cup),Object.entries(rt.head));function st(e,t){var r={flower:{},feather:{},sand:{},cup:{},head:{}};t=t.replace("phys","物理伤害加成").replace("雷","雷元素伤害加成").replace("岩","岩元素伤害加成").replace("风","风元素伤害加成").replace("水","水元素伤害加成").replace("火","火元素伤害加成");for(var n=0;n<45;n++)Object.keys(rt.second).map((function(n){var o=JSON.parse(JSON.stringify(r));for(var a in o){const e=o[a],t=Object.values(e);if((4==t.length?e[n]:!e[n])&&(e[n]||0)<6&&t.reduce(((e,t)=>e+t),0)<9){e[n]=(e[n]||0)+1;break}}var s=ot(o);return[nt(e["角色攻击力"]||0,e["武器攻击力"]||0,et(tt(rt.second["攻击力%"],s["攻击力%"]||0),e["攻击力%"]||0),et(tt(rt.second["攻击力"],s["攻击力"]||0),e["攻击力"]||0),e["技能倍率"]||0,e[t]||0,et(tt(rt.second["暴击率"],s["暴击率"]||0),e["暴击率"]||0),et(tt(rt.second["暴击伤害"],s["暴击伤害"]||0),e["暴击伤害"]||0)),()=>r=o]})).sort(((e,t)=>t[0]-e[0]))[0][1]();for(var[o,a]of Object.entries(ot(r)))e[o]=et(e[o]||0,tt(rt.second[o],a));return[nt(e["角色攻击力"]||0,e["武器攻击力"]||0,e["攻击力%"]||0,e["攻击力"]||0,e["技能倍率"]||0,e[t]||0,e["暴击率"]||0,e["暴击伤害"]||0),e]}const it=(e,t,r,n,o)=>{let a=[];for(let c of at){let u={"角色攻击力":t,"武器攻击力":r,"技能倍率":n};for(var[s,i]of o)u[s]=et(u[s]||0,i);for(var[s,i]of c)u[s]=et(u[s]||0,i);a.push(st(u,e))}return[...a].sort(((e,t)=>t[0]-e[0]))[0]};export{Je as $,he as A,m as B,B as C,ue as D,le as E,pe as F,De as G,V as H,J as I,$ as J,Xe as K,z as L,He as M,Ye as N,ie as O,ce as P,q as Q,Fe as R,ve as S,Ie as T,E as U,je as V,Ze as W,qe as X,Ge as Y,We as Z,Ve as _,f as a,it as a0,P as b,F as c,I as d,N as e,A as f,fe as g,_ as h,ge as i,y as j,j as k,k as l,w as m,u as n,S as o,U as p,L as q,H as r,g as s,T as t,D as u,p as v,b as w,Be as x,Ue as y,de as z};
